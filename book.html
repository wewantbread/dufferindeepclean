diff --git a/book.html b/book.html
index 78f8190b55235c8a56c1fddcc248c8bb8d4de80d..3e1772b915baec29c0477978effb6f90e25cab9e 100644
--- a/book.html
+++ b/book.html
@@ -1,745 +1,2817 @@
 <!DOCTYPE html>
 <html lang="en">
 <head>
   <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
   <title>Book Online ‚Äî DufferinDeepClean</title>
 
-  <!-- Fonts (match index + About Us script) -->
   <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;600;800&family=Great+Vibes&display=swap" rel="stylesheet" />
-
-  <!-- Site CSS (keep your existing file) -->
   <link rel="stylesheet" href="style.css" />
+  <script src="nav-cart.js" defer></script>
 
-  <!-- Page-specific styles to: 
-       1) match index animated background (slightly darker here),
-       2) unify logo font + animation,
-       3) keep your booking UI exactly as-is otherwise. -->
   <style>
-    /* ===== Animated seamless background (same as index, slightly darker) ===== */
     :root{
-      /* Use the same seamless tile image you use on index */
-      --bg-tile: url('backgroundbook.png');    /* or cleaning-pattern.png if that‚Äôs your tile */
+      --bg-tile: url('backgroundbook.png');
       --tile-w: 1536px;
       --tile-h: 1024px;
       --tile-scale: 0.90;
       --tile-w-size: calc(var(--tile-w) * var(--tile-scale));
       --tile-h-size: calc(var(--tile-h) * var(--tile-scale));
-
-      /* Darker overlay than index (index ‚âà 0.40/0.66/0.80) */
       --overlay-a: rgba(0,0,0,0.52);
       --overlay-b: rgba(0,0,0,0.78);
       --overlay-c: rgba(0,0,0,0.90);
     }
 
     html, body { min-height: 100%; background:#000; }
     body {
       color: #f2f5f8;
       font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
       background: transparent !important;
     }
 
-    /* Animated tile layer (under content) */
     body::after{
       content:"";
       position: fixed; inset: 0; z-index: 0; pointer-events: none;
       background-image: var(--bg-tile);
       background-repeat: repeat;
       background-size: var(--tile-w-size) var(--tile-h-size);
       background-position: 0 0;
       animation: bgInfinite 56s linear infinite;
     }
     @keyframes bgInfinite {
       from { background-position: 0 0; }
       to   { background-position: var(--tile-w-size) var(--tile-h-size); }
     }
 
-    /* Darker readability overlay for booking page */
     body::before{
       content:"";
       position: fixed; inset: 0; z-index: 1; pointer-events: none;
-      background: radial-gradient(1200px 600px at 50% -10%,
-                  var(--overlay-a), var(--overlay-b) 60%, var(--overlay-c));
+      background: radial-gradient(1200px 600px at 50% -10%, var(--overlay-a), var(--overlay-b) 60%, var(--overlay-c));
     }
 
-    /* Ensure all content sits above background layers */
     .navbar, main, section, footer { position: relative; z-index: 2; }
 
-    /* ===== NAV: transparent like index, unified logo font + left‚Üíright unveil ===== */
     .navbar{
-      display:flex; justify-content:space-between; align-items:center;
+      display:flex;
+      justify-content:space-between;
+      align-items:center;
+      gap: clamp(1rem, 2vw, 2.4rem);
       padding: 14px 22px;
-      background: rgba(0,0,0,0.20);           /* transparent header over the moving bg */
+      background: rgba(0,0,0,0.20);
       backdrop-filter: blur(6px);
       border-bottom: 1px solid rgba(255,255,255,0.08);
       position: sticky; top: 0; z-index: 1000;
     }
     .logo{ display:flex; align-items:center; gap:.55rem; }
     .logo .soap{ font-size: 2.2rem; transform: translateY(2px); }
     .logo .logo-text{
-      font-family: 'Great Vibes', cursive !important;  /* match About Us */
+      font-family: 'Great Vibes', cursive !important;
       font-size: 2.8rem; line-height: 1; letter-spacing: .4px; color:#fff;
       position:relative; display:inline-block;
       clip-path: inset(0 100% 0 0); opacity:0;
       animation: logoUnveil 1.1s ease forwards .25s;
       text-decoration: none;
     }
     @keyframes logoUnveil{0%{clip-path:inset(0 100% 0 0);opacity:0}40%{opacity:1}100%{clip-path:inset(0 0 0 0);opacity:1}}
     @keyframes logoSweep{0%{opacity:1;transform:translateX(-105%)}60%{opacity:.75}100%{opacity:0;transform:translateX(120%)}}
     .logo .logo-text::after{
       content:""; position:absolute; inset:0;
       background: linear-gradient(90deg, rgba(0,212,255,.85), rgba(255,255,255,.95));
       mix-blend-mode: screen; opacity:0; pointer-events:none;
       animation: logoSweep 1.1s ease forwards .25s;
     }
 
-    /* Nav links match site look */
     .nav-links a{
-      font-family: 'Bebas Neue', sans-serif;
-      letter-spacing: .5px;
-      color: #cfe0ee; text-decoration:none; margin-left:18px;
+      font-family: 'Inter', sans-serif;
+      font-weight: 700;
+      text-transform: uppercase;
+      letter-spacing: 0.16em;
+      font-size: 0.95rem;
+      color: #e9f7ff;
+      text-decoration:none;
+      margin-left:18px;
       transition: color .25s ease;
     }
     .nav-links a:hover{ color:#fff; }
 
-    /* ===== Booking page layout (your original UI, unchanged) ===== */
+    .nav-actions{
+      display:flex;
+      align-items:center;
+      gap: clamp(0.6rem, 1.2vw, 1.1rem);
+    }
+
+    .nav-cart{
+      background: rgba(0,0,0,0.35);
+      border: 1px solid rgba(0,212,255,0.32);
+      padding: 0.5em 1em;
+      color: #f1fbff;
+    }
+
     .booking{
-      max-width: 1100px; margin: 0 auto;
+      max-width: 1220px; margin: 0 auto;
       padding: clamp(20px, 4vw, 48px);
     }
     .booking-title{
       font-family: "Bebas Neue", system-ui, sans-serif;
       font-size: clamp(36px, 6vw, 72px);
       letter-spacing: 1px;
       margin: 10px 0 18px;
       text-transform: lowercase;
     }
 
     .stepper-wrap{ width: 100%; display:flex; justify-content:center; }
     .stepper{
       list-style: none; padding: 10px; margin: 0;
       width: min(100%, 1050px);
       display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px;
       background: rgba(0, 0, 0, 0.55);
       border: 1px solid rgba(255,255,255,0.08);
       border-radius: 16px;
       box-shadow: 0 10px 30px rgba(0,0,0,0.35);
       backdrop-filter: blur(6px);
+      text-transform: lowercase;
     }
     .stepper li{
       padding: 14px 12px; text-align: center; border-radius: 12px;
-      font-weight: 600; text-transform: lowercase; color: #b6c2cf;
+      font-weight: 600; color: #b6c2cf;
       border: 1px dashed rgba(255,255,255,0.12);
       transition: transform .2s ease, background .2s ease, color .2s ease, border-color .2s ease;
+      cursor: default;
+    }
+    .stepper li.clickable{
+      cursor: pointer;
+    }
+    .stepper li.clickable:focus-visible{
+      outline: 2px solid rgba(255,255,255,0.7);
+      outline-offset: 2px;
     }
     .stepper li.done{
       color: #0f0;
       border-color: rgba(0, 208, 132, 0.35);
       background: linear-gradient(180deg, rgba(0,208,132,0.12), rgba(0,208,132,0.05));
     }
     .stepper li.active{
-      color: #111; 
-      background: linear-gradient(180deg, #ffd166, #ffb703);
-      border-color: rgba(255,183,3,0.65);
+      color: #fff;
+      background: linear-gradient(180deg, #ff90dc, #ff4fc3);
+      border-color: rgba(255, 128, 210, 0.7);
+      box-shadow: 0 12px 28px rgba(255, 110, 205, 0.25);
       transform: translateY(-1px);
     }
 
     .booking-card{
-      margin: 18px auto 0; width: min(100%, 1050px);
-      background: rgba(10, 12, 16, 0.72);     /* slightly darker card to match page darkness */
+      margin: 18px auto 0; width: min(100%, 1280px);
+      background: rgba(10, 12, 16, 0.72);
       border: 1px solid rgba(255,255,255,0.08);
       border-radius: 20px;
       box-shadow: 0 20px 50px rgba(0,0,0,0.45);
       backdrop-filter: blur(8px);
       overflow: hidden;
     }
-    .booking-form, .booking-success{ padding: clamp(16px, 3vw, 28px); }
+    .booking-layout{
+      display: flex;
+      flex-direction: column;
+      gap: clamp(18px, 3vw, 32px);
+      padding: clamp(18px, 3vw, 32px);
+    }
+    .booking-form{
+      padding: 0;
+    }
+
+    .form-columns{
+      display: grid;
+      gap: clamp(36px, 5.5vw, 72px);
+      align-items: start;
+      grid-template-columns: minmax(0, 1fr);
+    }
+
+    .form-columns.cart-summary-hidden{
+      grid-template-columns: 1fr !important;
+    }
+
+    .form-steps{
+      display: grid;
+      gap: clamp(18px, 3vw, 28px);
+      min-width: 0;
+    }
+    .booking-success{ padding: clamp(16px, 3vw, 28px); }
 
     fieldset{ border: none; margin: 0; padding: 0; }
     legend{ font-weight: 800; font-size: 1.2rem; margin-bottom: 14px; }
     .muted{ color: #b6c2cf; }
+    .legend-note{
+      display: block;
+      margin-top: 4px;
+      font-size: 0.9rem;
+      font-weight: 400;
+      color: #b6c2cf;
+    }
+
+    .cart-summary{
+      background: rgba(7, 18, 32, 0.74);
+      border: 1px solid rgba(255, 140, 220, 0.32);
+      border-radius: 18px;
+      padding: clamp(14px, 2vw, 20px);
+      box-shadow: 0 12px 30px rgba(0,0,0,0.35);
+      display: grid;
+      gap: clamp(10px, 1.6vw, 16px);
+      width: 100%;
+      max-width: 390px;
+      min-width: 0;
+      margin-left: auto;
+      transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
+    }
+    .cart-summary.cart-summary-empty .cart-summary-subtitle{ color: #9ad4ff; }
+    .cart-summary.cart-summary-empty .cart-pricing .cart-line span:last-child{ color: rgba(214, 238, 255, 0.6); }
+
+    .cart-summary.is-added{
+      border-color: rgba(255, 140, 220, 0.6);
+      box-shadow: 0 20px 46px rgba(0,0,0,0.45), 0 0 0 2px rgba(255, 140, 220, 0.18);
+      opacity: 0.96;
+    }
+
+    .cart-summary-flight{
+      animation: cartSummaryFlight 0.65s ease;
+    }
+
+    .cart-summary header{
+      display: flex;
+      align-items: center;
+      gap: 12px;
+    }
+
+    .cart-summary img{
+      width: 64px;
+      height: 64px;
+      object-fit: cover;
+      border-radius: 14px;
+      border: 1px solid rgba(255,255,255,0.12);
+      background: rgba(255,255,255,0.1);
+      box-shadow: 0 10px 24px rgba(0,0,0,0.35);
+    }
+
+    .cart-summary-title{
+      margin: 0;
+      font-family: "Bebas Neue", system-ui, sans-serif;
+      font-size: clamp(20px, 3vw, 26px);
+      letter-spacing: 0.1em;
+      text-transform: uppercase;
+    }
+
+    .cart-summary-subtitle{
+      color: #b6c2cf;
+      font-size: 0.85rem;
+      margin: 2px 0 0;
+    }
+
+    .cart-details{
+      font-size: 0.85rem;
+      color: #99b3cc;
+      line-height: 1.45;
+    }
+    .cart-detail-line{
+      display: block;
+      padding: 2px 0;
+    }
+
+    .cart-pricing{
+      border-radius: 16px;
+      border: 1px solid rgba(0, 212, 255, 0.2);
+      background: rgba(4, 18, 28, 0.65);
+      padding: 12px;
+      display: grid;
+      gap: 6px;
+    }
+
+    .cart-line{
+      display: flex;
+      justify-content: space-between;
+      align-items: center;
+      font-size: 0.9rem;
+      color: #d7e7f8;
+    }
+
+    .cart-line.total{
+      font-weight: 700;
+      font-size: 1rem;
+    }
+
+    .cart-line.deposit{
+      color: #00d084;
+      font-weight: 600;
+    }
+
+    .cart-line.balance{
+      color: #fbd38d;
+    }
+
+    .cart-divider{
+      height: 1px;
+      background: linear-gradient(90deg, rgba(0,212,255,0), rgba(0,212,255,0.45), rgba(0,212,255,0));
+      margin: 2px 0;
+    }
+
+    @keyframes cartSummaryFlight{
+      0% { transform: translateY(0); opacity: 1; }
+      40% { transform: translateY(-6px); opacity: 0.92; }
+      100% { transform: translateY(0); opacity: 1; }
+    }
+
+    .cart-btn{
+      display: inline-flex;
+      align-items: center;
+      justify-content: center;
+      gap: 0.55rem;
+      text-transform: uppercase;
+      letter-spacing: 0.12em;
+      font-weight: 700;
+      background: linear-gradient(180deg, #ff8edb, #ff4fc3);
+      border-color: rgba(255, 112, 210, 0.75);
+      color: #fff;
+      box-shadow: 0 12px 32px rgba(255, 110, 205, 0.35);
+    }
+
+    .cart-btn:disabled{
+      background: linear-gradient(180deg, rgba(255, 142, 219, 0.28), rgba(255, 79, 195, 0.2));
+      border-color: rgba(255, 112, 210, 0.35);
+      color: rgba(255,255,255,0.68);
+      box-shadow: none;
+    }
+
+    .cart-btn.is-added{
+      background: linear-gradient(180deg, #ff9ee4, #ff64d0);
+      border-color: rgba(255, 140, 220, 0.85);
+      color: #fff;
+    }
+
+    .cart-btn-icon{
+      display: inline-flex;
+      align-items: center;
+      justify-content: center;
+      width: 1.2rem;
+      height: 1.2rem;
+    }
+
+    .cart-btn-icon svg{ width: 100%; height: 100%; }
+
+    .cart-btn.is-added .cart-btn-icon{
+      filter: drop-shadow(0 0 6px rgba(255, 160, 224, 0.55));
+    }
+
+    .cart-status{
+      min-height: 1em;
+      font-size: 0.9rem;
+      color: #9ad4ff;
+    }
+
+    .cart-status.error{ color: #ff6b9a; }
+
+    .payment-policy{
+      border-radius: 14px;
+      border: 1px dashed rgba(255,255,255,0.18);
+      padding: 14px;
+      font-size: 0.9rem;
+      color: #d7e7f8;
+      background: rgba(255,255,255,0.02);
+    }
+
+    .payment-policy h3{
+      margin-top: 0;
+      font-size: 1rem;
+      text-transform: uppercase;
+      letter-spacing: 0.12em;
+      color: #ffe0f7;
+    }
+
+    .payment-policy p{ margin: 0; }
 
     .grid-2{ display: grid; gap: 14px; grid-template-columns: 1fr; }
     .grid-2 .wide{ grid-column: 1 / -1; }
     @media (min-width: 720px){ .grid-2{ grid-template-columns: 1fr 1fr; } }
 
     label{ display:flex; flex-direction:column; gap:6px; font-size: .95rem; }
     input, select, textarea{
       border-radius: 12px; border: 1px solid rgba(255,255,255,0.08); padding: 12px 12px;
       background: rgba(255,255,255,0.05); color: #f2f5f8; outline: none;
     }
     input:focus, select:focus, textarea:focus{
       border-color: rgba(76,195,255,0.7);
       box-shadow: 0 0 0 3px rgba(76,195,255,0.25);
       background: rgba(255,255,255,0.08);
     }
 
-    .plans{ display:grid; gap:12px; grid-template-columns: 1fr; }
-    @media (min-width: 840px){ .plans{ grid-template-columns: repeat(3, 1fr); } }
+    .plans{ display:grid; gap:20px; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); }
+    @media (min-width: 900px){ .plans{ grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); } }
     .plan{ display:block; }
     .plan input{ display:none; }
     .plan-card{
-      border: 1px solid rgba(255,255,255,0.08); border-radius: 14px; padding: 14px;
+      border: 1px solid rgba(255,255,255,0.08); border-radius: 14px; padding: clamp(18px, 2.8vw, 26px);
       background: rgba(255,255,255,0.04);
       transition: transform .2s ease, border-color .2s ease, background .2s ease;
+      min-height: 165px;
     }
     .plan input:checked + .plan-card{
       border-color: rgba(0,208,132,0.6);
       background: linear-gradient(180deg, rgba(0,208,132,0.12), rgba(0,208,132,0.05));
       transform: translateY(-1px);
     }
     .plan-title{ font-weight: 800; }
     .plan-discount{ color: #00d084; font-weight: 700; }
     .plan-note{ color: #b6c2cf; font-size: .9rem; }
 
     .actions{ margin-top: 18px; display:flex; gap:10px; justify-content:flex-end; flex-wrap: wrap; }
+    .step[data-step="1"] .actions{ justify-content:flex-start; }
     .btn{
       appearance: none; border: 1px solid rgba(255,255,255,0.08); color: #0b0d10;
       background: linear-gradient(180deg, #4cc3ff, #00e0a4);
       font-weight: 800; border-radius: 12px; padding: 10px 16px; cursor: pointer;
     }
     .btn.back{
       background: rgba(255,255,255,0.06); color: #f2f5f8;
     }
-    .btn:hover{ filter: brightness(1.05); }
-
-    .package-desc{
-      border: 1px dashed rgba(255,255,255,0.2);
-      border-radius: 12px;
-      padding: 12px;
-      background: rgba(255,255,255,0.03);
+    .btn.skip{
+      background: rgba(255,255,255,0.08);
+      color: #e9f7ff;
+      border-color: rgba(255,255,255,0.18);
     }
+    .btn:hover{ filter: brightness(1.05); }
 
     .review{
       display:grid; gap:10px;
       border: 1px solid rgba(255,255,255,0.08);
       background: rgba(255,255,255,0.04);
       border-radius: 12px;
       padding: 14px;
     }
     .review dt{ font-weight: 700; color: #b6c2cf; }
     .review dd{ margin: 0 0 10px; }
+
+    .addon-empty{ color: rgba(214, 238, 255, 0.7); font-size: 0.95rem; }
+
+    @media (min-width: 860px){
+      .form-columns{
+        grid-template-columns: minmax(0, 1.55fr) minmax(360px, 1fr);
+        gap: clamp(56px, 6.4vw, 88px);
+        align-items: start;
+      }
+      .cart-summary{
+        position: sticky;
+        top: 24px;
+        max-height: calc(100vh - 80px);
+        overflow: auto;
+        justify-self: end;
+        margin-left: clamp(20px, 3vw, 32px);
+        width: min(100%, 420px);
+      }
+    }
+    @media (min-width: 1120px){
+      .form-columns{
+        grid-template-columns: minmax(0, 1.75fr) minmax(420px, 1fr);
+        gap: clamp(68px, 6.8vw, 108px);
+      }
+      .plans{ grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
+      .cart-summary{
+        max-width: 460px;
+      }
+    }
+    @media (min-width: 1360px){
+      .form-columns{
+        grid-template-columns: minmax(0, 1.85fr) minmax(440px, 1fr);
+        gap: clamp(72px, 6.4vw, 120px);
+      }
+    }
+
+    .step-frequency .plans{ margin-bottom: 0; }
   </style>
 </head>
-<body>
-  <!-- NAV -->
+<body data-paypal-client-id="" data-paypal-currency="CAD">
   <header class="navbar">
     <div class="logo">
       <span class="soap">üßº</span>
       <a class="logo-text" href="index.html">DufferinDeepClean</a>
     </div>
     <nav class="nav-links">
       <a href="index.html#home">Home</a>
       <a href="index.html#services">Services</a>
       <a href="about.html">About Us</a>
+      <a href="book.html#start" class="quote-btn">Book Online</a>
     </nav>
+    <div class="nav-actions">
+      <button class="nav-cart" type="button" data-cart-toggle aria-haspopup="dialog" aria-controls="navCartPopover" aria-expanded="false">
+        <span class="nav-cart-icon" aria-hidden="true">
+          <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
+            <path d="M4.5 4h-2a.5.5 0 0 1 0-1h2.8a1 1 0 0 1 .97.76L6.7 6H21a1 1 0 0 1 .96 1.27l-2 7A1 1 0 0 1 19 15H9.24l-.78 2.34A1 1 0 0 1 7.52 18H4.5a.5.5 0 0 1 0-1h2.55l3.2-9.6L9.8 6H4.78a1 1 0 0 1-.95-.68L4.5 4Zm4.28 3-2.4 7.2H19.1l1.71-6H8.78ZM9 19.75a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0Zm9.5 0a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0Z" fill="currentColor"/>
+          </svg>
+        </span>
+        <span class="nav-cart-label">Cart</span>
+        <span class="nav-cart-count" data-cart-count hidden>0</span>
+      </button>
+    </div>
   </header>
+  <aside class="nav-cart-popover" id="navCartPopover" role="dialog" aria-modal="false" aria-label="Cart summary" hidden>
+    <div class="nav-cart-popover-inner">
+      <button type="button" class="cart-popover-close" data-cart-close aria-label="Close cart">
+        <span aria-hidden="true">&times;</span>
+      </button>
+      <header class="cart-popover-header">
+        <img data-cart-popover-image alt="Cart package preview" loading="lazy" />
+        <div>
+          <p class="cart-popover-title" data-popover-service>Your cart is empty</p>
+          <p class="cart-popover-subtitle" data-popover-frequency>Build a package to see pricing here.</p>
+        </div>
+      </header>
+      <p class="cart-popover-status" data-popover-status hidden></p>
+      <p class="cart-popover-empty" data-popover-empty>Use ‚ÄúBook Online‚Äù to customise your cleaning package.</p>
+      <dl class="cart-popover-details" data-popover-details hidden></dl>
+      <div class="cart-popover-totals" data-popover-totals hidden>
+        <div><span>Visit total</span><span data-popover-total>‚Äî</span></div>
+        <div><span>Deposit (50%)</span><span data-popover-deposit>‚Äî</span></div>
+        <div><span>Balance</span><span data-popover-balance>‚Äî</span></div>
+      </div>
+      <div class="cart-popover-payments" data-popover-payments hidden>
+        <div id="nav-paypal-buttons" data-paypal-container="nav"></div>
+        <p class="cart-popover-paypal-status" id="nav-paypal-status" role="status" aria-live="polite"></p>
+        <button type="button" class="btn cart-popover-google" data-google-pay-button disabled>Google Pay (coming soon)</button>
+      </div>
+    </div>
+  </aside>
 
-  <section class="booking">
+  <section class="booking" id="start">
     <h1 class="booking-title">book online</h1>
 
-    <!-- Long, centered step rectangle -->
     <div class="stepper-wrap">
       <ol class="stepper" id="stepper">
-        <li class="active">1. when &amp; where</li>
-        <li>2. how often</li>
-        <li>3. cleaning type</li>
-        <li>4. your details</li>
+        <li class="active">1. add extras</li>
+        <li>2. frequency</li>
+        <li>3. your details</li>
+        <li>4. when &amp; where</li>
         <li>5. review &amp; confirm</li>
       </ol>
     </div>
 
-    <!-- Application card -->
     <div class="booking-card">
-      <form id="bookingForm" class="booking-form" action="https://formspree.io/f/mrblyqpr" method="POST">
-        <!-- STEP 1: When & Where -->
-        <fieldset class="step" data-step="1">
-          <legend>When &amp; Where</legend>
-          <div class="grid-2">
-            <label>
-              Business name (optional)
-              <input type="text" name="business" placeholder="ACME Distribution" />
-            </label>
-            <label>
-              Address
-              <input id="address" type="text" name="address" placeholder="123 Main St" required autocomplete="address-line1" />
-            </label>
-            <label>
-              City
-              <input id="city" type="text" name="city" placeholder="Mono" required autocomplete="address-level2" />
-            </label>
-            <label>
-              Postal Code
-              <input id="postal" type="text" name="postal" placeholder="L9W 1A1" required autocomplete="postal-code" />
-            </label>
-            <label>
-              Preferred date
-              <input type="date" name="date" required />
-            </label>
-            <label>
-              Preferred time
-              <input type="time" name="time" required />
-            </label>
-            <label class="wide">
-              Approx. square footage
-              <input type="number" name="sqft" min="100" step="50" placeholder="e.g., 5,000" required />
-            </label>
+      <div class="booking-layout" id="bookingLayout">
+                <form id="bookingForm" class="booking-form" action="https://formspree.io/f/mrblyqpr" method="POST">
+
+          <input type="hidden" name="service_key" id="input-service-key">
+          <input type="hidden" name="service_label" id="input-service-label">
+          <input type="hidden" name="square_footage_range" id="input-sqft-label">
+          <input type="hidden" name="detail_summary" id="input-detail-summary">
+          <input type="hidden" name="base_package_price" id="input-base-price">
+          <input type="hidden" name="service_detail_price" id="input-detail-price">
+          <input type="hidden" name="addons_price" id="input-addons-price">
+          <input type="hidden" name="frequency_savings" id="input-discount-price">
+          <input type="hidden" name="deposit_due" id="input-deposit-price">
+          <input type="hidden" name="balance_due" id="input-balance-price">
+          <input type="hidden" name="final_visit_total" id="input-total-price">
+          <input type="hidden" name="selected_addons" id="input-selected-addons">
+          <input type="hidden" name="origin_quote" id="input-origin" value="">
+          <input type="hidden" name="package" id="input-package">
+          <input type="hidden" name="paypal_order_id" id="input-paypal-order-id">
+          <input type="hidden" name="paypal_payer_id" id="input-paypal-payer-id">
+          <input type="hidden" name="paypal_capture_id" id="input-paypal-capture-id">
+          <input type="hidden" name="cart_status" id="input-cart-status" value="pending">
+          <input type="hidden" name="name" id="input-full-name" value="">
+
+          <div class="form-columns">
+            <div class="form-steps">
+
+        <fieldset class="step step-extras" data-step="1">
+          <legend>Add extra services <span class="legend-note">Optional boosts to tailor your visit.</span></legend>
+          <p class="muted">Select any speciality tasks you‚Äôd like to include or skip to keep the base package.</p>
+          <div class="addon-groups" id="addon-groups">
+            <div class="addon-group" data-service-group="home">
+              <p class="addon-group-title">Home &amp; Residential Extras</p>
+              <div class="addon-pill color-cyan" data-addon="Deep Clean Package" data-price="80">
+                <span class="addon-icon" data-icon="sparkle" aria-hidden="true"></span>
+                <span class="addon-name">Deep Clean Package</span>
+                <div class="addon-stepper" role="group" aria-label="Deep Clean Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Deep Clean Package quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Deep Clean Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Deep Clean Package quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-lime" data-addon="Move In/Out Clean Package" data-price="95">
+                <span class="addon-icon" data-icon="truck" aria-hidden="true"></span>
+                <span class="addon-name">Move In/Out Clean Package</span>
+                <div class="addon-stepper" role="group" aria-label="Move In/Out Clean Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Move In/Out Clean Package quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Move In/Out Clean Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Move In/Out Clean Package quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-magenta" data-addon="Renovation Clean Package" data-price="110">
+                <span class="addon-icon" data-icon="tool" aria-hidden="true"></span>
+                <span class="addon-name">Renovation Clean Package</span>
+                <div class="addon-stepper" role="group" aria-label="Renovation Clean Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Renovation Clean Package quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Renovation Clean Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Renovation Clean Package quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-orange" data-addon="Move In/Out Package (Student Property)" data-price="70">
+                <span class="addon-icon" data-icon="cap" aria-hidden="true"></span>
+                <span class="addon-name">Move In/Out Package (Student Property)</span>
+                <div class="addon-stepper" role="group" aria-label="Move In/Out Package (Student Property) quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Move In/Out Package (Student Property) quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Move In/Out Package (Student Property) quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Move In/Out Package (Student Property) quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-indigo" data-addon="AirBnB Listing" data-price="65">
+                <span class="addon-icon" data-icon="home" aria-hidden="true"></span>
+                <span class="addon-name">AirBnB Listing</span>
+                <div class="addon-stepper" role="group" aria-label="AirBnB Listing quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease AirBnB Listing quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="AirBnB Listing quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase AirBnB Listing quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-gold" data-addon="I have Pets" data-price="35">
+                <span class="addon-icon" data-icon="paw" aria-hidden="true"></span>
+                <span class="addon-name">I have Pets</span>
+                <div class="addon-stepper" role="group" aria-label="I have Pets quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease I have Pets quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="I have Pets quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase I have Pets quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-sky" data-addon="Inside Fridge" data-price="25">
+                <span class="addon-icon" data-icon="fridge" aria-hidden="true"></span>
+                <span class="addon-name">Inside Fridge</span>
+                <div class="addon-stepper" role="group" aria-label="Inside Fridge quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Inside Fridge quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Inside Fridge quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Inside Fridge quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-rose" data-addon="Inside Oven" data-price="25">
+                <span class="addon-icon" data-icon="oven" aria-hidden="true"></span>
+                <span class="addon-name">Inside Oven</span>
+                <div class="addon-stepper" role="group" aria-label="Inside Oven quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Inside Oven quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Inside Oven quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Inside Oven quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-mint" data-addon="Inside Cabinets" data-price="30">
+                <span class="addon-icon" data-icon="cabinet" aria-hidden="true"></span>
+                <span class="addon-name">Inside Cabinets</span>
+                <div class="addon-stepper" role="group" aria-label="Inside Cabinets quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Inside Cabinets quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Inside Cabinets quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Inside Cabinets quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-teal" data-addon="Additional Kitchen" data-price="45">
+                <span class="addon-icon" data-icon="utensils" aria-hidden="true"></span>
+                <span class="addon-name">Additional Kitchen</span>
+                <div class="addon-stepper" role="group" aria-label="Additional Kitchen quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Additional Kitchen quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Additional Kitchen quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Additional Kitchen quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-plum" data-addon="Blinds (per window)" data-price="8">
+                <span class="addon-icon" data-icon="blinds" aria-hidden="true"></span>
+                <span class="addon-name">Blinds (per window)</span>
+                <div class="addon-stepper" role="group" aria-label="Blinds (per window) quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Blinds quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="25" value="1" aria-label="Blinds quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Blinds quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-azure" data-addon="Inside Windows with Tracks (up to 6)" data-price="60">
+                <span class="addon-icon" data-icon="window" aria-hidden="true"></span>
+                <span class="addon-name">Inside Windows with Tracks (up to 6)</span>
+                <div class="addon-stepper" role="group" aria-label="Inside Windows with Tracks (up to 6) quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Inside Windows with Tracks (up to 6) quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="5" value="1" aria-label="Inside Windows with Tracks up to 6 quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Inside Windows with Tracks (up to 6) quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-amber" data-addon="Inside Windows with Tracks (up to 12)" data-price="105">
+                <span class="addon-icon" data-icon="window" aria-hidden="true"></span>
+                <span class="addon-name">Inside Windows with Tracks (up to 12)</span>
+                <div class="addon-stepper" role="group" aria-label="Inside Windows with Tracks (up to 12) quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Inside Windows with Tracks (up to 12) quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="5" value="1" aria-label="Inside Windows with Tracks up to 12 quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Inside Windows with Tracks (up to 12) quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-blue" data-addon="Inside Windows with Tracks (up to 24)" data-price="195">
+                <span class="addon-icon" data-icon="window" aria-hidden="true"></span>
+                <span class="addon-name">Inside Windows with Tracks (up to 24)</span>
+                <div class="addon-stepper" role="group" aria-label="Inside Windows with Tracks (up to 24) quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Inside Windows with Tracks (up to 24) quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="5" value="1" aria-label="Inside Windows with Tracks up to 24 quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Inside Windows with Tracks (up to 24) quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-lavender" data-addon="Change Bed Sheets + Load Laundry" data-price="18">
+                <span class="addon-icon" data-icon="bed" aria-hidden="true"></span>
+                <span class="addon-name">Change Bed Sheets + Load Laundry</span>
+                <div class="addon-stepper" role="group" aria-label="Change Bed Sheets + Load Laundry quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Change Bed Sheets quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Change Bed Sheets quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Change Bed Sheets quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-crimson" data-addon="Load Dishwasher" data-price="10">
+                <span class="addon-icon" data-icon="dish" aria-hidden="true"></span>
+                <span class="addon-name">Load Dishwasher</span>
+                <div class="addon-stepper" role="group" aria-label="Load Dishwasher quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Load Dishwasher quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Load Dishwasher quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Load Dishwasher quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-emerald" data-addon="Sanitization Package" data-price="55">
+                <span class="addon-icon" data-icon="spray" aria-hidden="true"></span>
+                <span class="addon-name">Sanitization Package</span>
+                <div class="addon-stepper" role="group" aria-label="Sanitization Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Sanitization Package quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Sanitization Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Sanitization Package quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+            </div>
+
+            <div class="addon-group" data-service-group="commercial,office">
+              <p class="addon-group-title">Facility &amp; Workspace Enhancements</p>
+              <div class="addon-pill color-indigo" data-addon="Carpet Steam Cleaning Package" data-price="140">
+                <span class="addon-icon" data-icon="vacuum" aria-hidden="true"></span>
+                <span class="addon-name">Carpet Steam Cleaning Package</span>
+                <div class="addon-stepper" role="group" aria-label="Carpet Steam Cleaning Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Carpet Steam Cleaning quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Carpet Steam Cleaning quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Carpet Steam Cleaning quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-azure" data-addon="Tile and Grout Cleaning Package" data-price="130">
+                <span class="addon-icon" data-icon="tiles" aria-hidden="true"></span>
+                <span class="addon-name">Tile and Grout Cleaning Package</span>
+                <div class="addon-stepper" role="group" aria-label="Tile and Grout Cleaning Package quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Tile and Grout quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Tile and Grout quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Tile and Grout quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-coral" data-addon="Window Detailing" data-price="120">
+                <span class="addon-icon" data-icon="squeegee" aria-hidden="true"></span>
+                <span class="addon-name">Window Detailing</span>
+                <div class="addon-stepper" role="group" aria-label="Window Detailing quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Window Detailing quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Window Detailing quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Window Detailing quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-lime" data-addon="Pressure Washing" data-price="165">
+                <span class="addon-icon" data-icon="pressure" aria-hidden="true"></span>
+                <span class="addon-name">Pressure Washing</span>
+                <div class="addon-stepper" role="group" aria-label="Pressure Washing quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Pressure Washing quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Pressure Washing quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Pressure Washing quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+              <div class="addon-pill color-rose" data-addon="Floor Strip &amp; Wax" data-price="185">
+                <span class="addon-icon" data-icon="floor" aria-hidden="true"></span>
+                <span class="addon-name">Floor Strip &amp; Wax</span>
+                <div class="addon-stepper" role="group" aria-label="Floor Strip and Wax quantity">
+                  <button type="button" class="stepper-button" data-qty-step="-1" aria-label="Decrease Floor Strip and Wax quantity"><span aria-hidden="true">‚àí</span></button>
+                  <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Floor Strip and Wax quantity">
+                  <button type="button" class="stepper-button" data-qty-step="1" aria-label="Increase Floor Strip and Wax quantity"><span aria-hidden="true">+</span></button>
+                </div>
+              </div>
+            </div>
           </div>
+          <p id="addon-empty-message" class="addon-empty" hidden>No add-ons are available for the package you selected.</p>
           <div class="actions">
+            <button type="button" class="btn skip">Skip extras</button>
             <button type="button" class="btn next">Next</button>
           </div>
         </fieldset>
 
-        <!-- STEP 2: How Often -->
-        <fieldset class="step" data-step="2" hidden>
-          <legend>How Often?</legend>
-          <p class="muted">Save on recurring cleanings. Choose a frequency.</p>
+        <fieldset class="step step-frequency" data-step="2" hidden>
+          <legend>Choose your visit frequency</legend>
           <div class="plans">
             <label class="plan">
-              <input type="radio" name="frequency" value="weekly" required />
+              <input type="radio" name="frequency" value="weekly" data-discount="0.25" required />
               <div class="plan-card">
                 <div class="plan-title">Weekly</div>
                 <div class="plan-discount">25% off</div>
                 <div class="plan-note">Best value &amp; consistency</div>
               </div>
             </label>
             <label class="plan">
-              <input type="radio" name="frequency" value="biweekly" />
+              <input type="radio" name="frequency" value="biweekly" data-discount="0.20" />
               <div class="plan-card">
                 <div class="plan-title">Bi-Weekly</div>
                 <div class="plan-discount">20% off</div>
                 <div class="plan-note">Great for busy offices</div>
               </div>
             </label>
             <label class="plan">
-              <input type="radio" name="frequency" value="triweekly" />
+              <input type="radio" name="frequency" value="triweekly" data-discount="0.15" />
               <div class="plan-card">
                 <div class="plan-title">Tri-Weekly</div>
                 <div class="plan-discount">15% off</div>
                 <div class="plan-note">Light traffic spaces</div>
               </div>
             </label>
             <label class="plan">
-              <input type="radio" name="frequency" value="monthly" />
+              <input type="radio" name="frequency" value="monthly" data-discount="0.10" />
               <div class="plan-card">
                 <div class="plan-title">Monthly</div>
                 <div class="plan-discount">10% off</div>
-                <div class="plan-note">Routine upkeep</div>
+                <div class="plan-note">Deep refresh once a month</div>
               </div>
             </label>
             <label class="plan">
-              <input type="radio" name="frequency" value="biannual" />
+              <input type="radio" name="frequency" value="biannual" data-discount="0.05" />
               <div class="plan-card">
                 <div class="plan-title">Biannual</div>
                 <div class="plan-discount">5% off</div>
-                <div class="plan-note">Seasonal refresh</div>
+                <div class="plan-note">Seasonal top-to-bottom</div>
               </div>
             </label>
             <label class="plan">
-              <input type="radio" name="frequency" value="onetime" />
+              <input type="radio" name="frequency" value="onetime" data-discount="0" />
               <div class="plan-card">
                 <div class="plan-title">One-time</div>
-                <div class="plan-discount">‚Äî</div>
-                <div class="plan-note">Deep clean on demand</div>
+                <div class="plan-discount">Standard rate</div>
+                <div class="plan-note">Perfect for move-ins &amp; projects</div>
               </div>
             </label>
           </div>
           <div class="actions">
             <button type="button" class="btn back">Back</button>
             <button type="button" class="btn next">Next</button>
           </div>
         </fieldset>
 
-        <!-- STEP 3: Cleaning Type + Packages -->
         <fieldset class="step" data-step="3" hidden>
-          <legend>What type of cleaning?</legend>
+          <legend>Your contact information</legend>
           <div class="grid-2">
+            <label>
+              First name
+              <input type="text" name="first_name" placeholder="Jane" autocomplete="given-name" required />
+            </label>
+            <label>
+              Last name (optional)
+              <input type="text" name="last_name" placeholder="Smith" autocomplete="family-name" />
+            </label>
+            <label>
+              Email
+              <input type="email" name="email" placeholder="you@company.com" autocomplete="email" required />
+            </label>
+            <label>
+              Phone
+              <input type="tel" name="phone" placeholder="(555) 555-5555" autocomplete="tel" />
+            </label>
             <label class="wide">
-              Select a package
-              <select name="package" id="package" required>
-                <option value="" disabled selected>Choose a package‚Ä¶</option>
-                <option value="industrial">üè≠ Industrial &amp; Warehouse Care</option>
-                <option value="office">üñ•Ô∏è Office &amp; Corporate Cleaning</option>
-                <option value="specialty">ü™ü Specialty Facility Services</option>
-              </select>
+              Notes (optional)
+              <textarea name="notes" rows="3" placeholder="Access details, special instructions, etc."></textarea>
             </label>
-
-            <!-- Industrial -->
-            <div class="package-desc" id="pkg-industrial" hidden>
-              <h4>üè≠ Industrial &amp; Warehouse Care</h4>
-              <p class="muted"><strong>Tagline:</strong> Heavy-duty cleaning for high-demand environments.<br/><strong>Ideal for:</strong> Factories, distribution centers, and large-scale workspaces.</p>
-              <ul>
-                <li>High-dusting and overhead beam cleaning</li>
-                <li>Sweeping, scrubbing, and degreasing of production floors</li>
-                <li>Equipment and machinery wipe-downs</li>
-                <li>Loading dock and storage area cleaning</li>
-                <li>Restroom cleaning and sanitation for high-traffic use</li>
-              </ul>
-            </div>
-
-            <!-- Office -->
-            <div class="package-desc" id="pkg-office" hidden>
-              <h4>üñ•Ô∏è Office &amp; Corporate Cleaning</h4>
-              <p class="muted"><strong>Tagline:</strong> A spotless, professional image for your business.<br/><strong>Ideal for:</strong> Offices, corporate headquarters, and professional buildings.</p>
-              <ul>
-                <li>Daily surface and workstation cleaning</li>
-                <li>Waste removal and recycling service</li>
-                <li>Floor care: vacuuming, mopping, and spot-cleaning carpets</li>
-                <li>Reception and common-area tidying</li>
-                <li>Restroom cleaning and supply replenishment</li>
-              </ul>
-            </div>
-
-            <!-- Specialty -->
-            <div class="package-desc" id="pkg-specialty" hidden>
-              <h4>ü™ü Specialty Facility Services</h4>
-              <p class="muted"><strong>Tagline:</strong> Targeted deep-cleaning for the areas that matter most.<br/><strong>Ideal for:</strong> Businesses needing targeted or seasonal deep-cleaning.</p>
-              <ul>
-                <li>Window washing and glass polishing (interior &amp; exterior)</li>
-                <li>Cafeteria / lunchroom cleaning and sanitization</li>
-                <li>Washroom deep-clean and disinfection</li>
-                <li>Touchpoint sanitization (doors, handles, switches)</li>
-                <li>Post-construction or move-out cleaning</li>
-              </ul>
-            </div>
           </div>
           <div class="actions">
             <button type="button" class="btn back">Back</button>
             <button type="button" class="btn next">Next</button>
           </div>
         </fieldset>
 
-        <!-- STEP 4: Contact -->
         <fieldset class="step" data-step="4" hidden>
-          <legend>Your contact information</legend>
+          <legend>When &amp; where should we clean?</legend>
           <div class="grid-2">
             <label>
-              Full name
-              <input type="text" name="name" placeholder="Jane Smith" required />
+              Business / Building Name
+              <input type="text" name="business" placeholder="Company or building" autocomplete="organization" />
             </label>
             <label>
-              Email
-              <input type="email" name="email" placeholder="you@company.com" required />
+              Street Address
+              <input type="text" name="address" placeholder="123 Queen St" autocomplete="street-address" required />
             </label>
             <label>
-              Phone
-              <input type="tel" name="phone" placeholder="(555) 555-5555" required />
+              City
+              <input type="text" name="city" placeholder="Toronto" autocomplete="address-level2" required />
+            </label>
+            <label>
+              Postal Code
+              <input type="text" name="postal" placeholder="M5H 2N2" autocomplete="postal-code" required />
+            </label>
+            <label>
+              Preferred Date
+              <input type="date" name="date" required />
+            </label>
+            <label>
+              Preferred Time Window
+              <select name="time" required>
+                <option value="">Select a time window</option>
+                <option value="morning">Morning (8am ‚Äì 11am)</option>
+                <option value="midday">Midday (11am ‚Äì 2pm)</option>
+                <option value="afternoon">Afternoon (2pm ‚Äì 5pm)</option>
+              </select>
             </label>
             <label class="wide">
-              Notes (optional)
-              <textarea name="notes" rows="3" placeholder="Access details, special instructions, etc."></textarea>
+              Square Footage (approx.)
+              <input type="number" name="sqft" min="100" step="50" placeholder="e.g., 5,000" />
             </label>
           </div>
           <div class="actions">
             <button type="button" class="btn back">Back</button>
             <button type="button" class="btn next">Next</button>
           </div>
         </fieldset>
 
-        <!-- STEP 5: Review & Confirm -->
         <fieldset class="step" data-step="5" hidden>
-          <legend>Review &amp; Confirm</legend>
-          <dl class="review" id="reviewList">
-            <!-- Filled by JS -->
-          </dl>
+          <legend>Review &amp; confirm</legend>
+          <p class="muted">Double-check every detail below, then finalize your booking when you're ready. Your cart summary stays on the right for a quick final check.</p>
+          <dl class="review" id="reviewList"></dl>
           <div class="actions">
             <button type="button" class="btn back">Back</button>
             <button type="submit" class="btn submit">Submit</button>
           </div>
         </fieldset>
-      </form>
+
+            </div>
+
+            <aside class="cart-summary" id="cartSummary" aria-label="Cart summary">
+              <header>
+                <img id="cartSummaryImage" alt="Custom cleaning package" loading="lazy" />
+                <div>
+                  <h2 class="cart-summary-title">Custom Package</h2>
+                  <p class="cart-summary-subtitle" data-cart-service>Choose a service to view details.</p>
+                </div>
+              </header>
+              <div class="cart-details" data-cart-description hidden></div>
+              <div class="cart-pricing" id="pricingRecap">
+                <div class="cart-line">
+                  <span>Base package</span>
+                  <span data-recap-base>‚Äî</span>
+                </div>
+                <div class="cart-line" data-recap-detail-row hidden>
+                  <span>Service details</span>
+                  <span data-recap-detail>‚Äî</span>
+                </div>
+                <div class="cart-line" data-recap-extras-row hidden>
+                  <span>Add-ons</span>
+                  <span data-recap-extras>‚Äî</span>
+                </div>
+                <div class="cart-line" data-recap-discount-row hidden>
+                  <span>Frequency savings</span>
+                  <span data-recap-discount>‚Äî</span>
+                </div>
+                <div class="cart-divider"></div>
+                <div class="cart-line total">
+                  <span>Visit total</span>
+                  <span data-recap-total>‚Äî</span>
+                </div>
+                <div class="cart-line deposit">
+                  <span>Deposit (50%)</span>
+                  <span id="deposit-due-text">‚Äî</span>
+                </div>
+                <div class="cart-line balance">
+                  <span>Balance at service</span>
+                  <span id="balance-due-text">‚Äî</span>
+                </div>
+              </div>
+              <button type="button" class="btn cart-btn" id="addToCartBtn" disabled>
+                <span class="cart-btn-icon" aria-hidden="true">
+                  <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
+                    <path d="M4.5 4h-2a.5.5 0 0 1 0-1h2.8a1 1 0 0 1 .97.76L6.7 6H21a1 1 0 0 1 .96 1.27l-2 7A1 1 0 0 1 19 15H9.24l-.78 2.34A1 1 0 0 1 7.52 18H4.5a.5.5 0 0 1 0-1h2.55l3.2-9.6L9.8 6H4.78a1 1 0 0 1-.95-.68L4.5 4Zm4.28 3-2.4 7.2H19.1l1.71-6H8.78ZM9 19.75a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0Zm9.5 0a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0Z" fill="currentColor"/>
+                  </svg>
+                </span>
+                <span class="cart-btn-text">Add to Cart</span>
+              </button>
+              <p class="cart-status" id="cartStatus" role="status" aria-live="polite"></p>
+              <div class="payment-policy">
+                <h3>Payment Policy</h3>
+                <p>A 50% deposit is required at the time of booking to secure your appointment. The remaining balance is due upon completion of the service. Deposits are non-refundable if cancellations occur within 48 hours of the scheduled cleaning.</p>
+              </div>
+            </aside>
+
+          </div>
+
+        </form>
+
+      </div>
 
       <div id="bookingSuccess" class="booking-success" hidden>
         <h2>Thanks! Your request has been received.</h2>
         <p>We‚Äôll get back to you within one business day to confirm your booking.</p>
         <a href="index.html" class="btn">Back to Home</a>
       </div>
     </div>
   </section>
 
-  <!-- iOS detector -->
   <script>
     (function () {
       var iOS = /iP(hone|od|ad)/.test(navigator.platform) || (navigator.userAgent.includes('Mac') && navigator.maxTouchPoints > 1);
       if (iOS) document.documentElement.classList.add('ios');
     })();
   </script>
 
-  <!-- Booking wizard JS (unchanged, just scoped to this page) -->
   <script>
     (function(){
-      const form = document.getElementById('bookingForm');
-      const steps = Array.from(document.querySelectorAll('.step'));
-      const stepper = document.getElementById('stepper').children;
-      const reviewList = document.getElementById('reviewList');
-      let current = 0;
+      const quoteForms = Array.from(document.querySelectorAll('form.quote-form'));
+      if(!quoteForms.length) return;
 
-      function showStep(i){
-        steps.forEach((s, idx)=>{ s.hidden = idx !== i; });
-        Array.from(stepper).forEach((li, idx)=>{
-          li.classList.toggle('active', idx === i);
-          li.classList.toggle('done', idx < i);
-        });
-        current = i;
-        if (i === 4) buildReview(); // step index 4 = "Step 5"
-        window.scrollTo({ top: 0, behavior: 'smooth' });
-      }
+      const basePricing = {
+        home: {
+          '1000-1500': 165,
+          '1500-2000': 185,
+          '2000-2500': 215,
+          '2500-3000': 245,
+          '3000-3500': 285,
+          '3500-4000': 325
+        },
+        commercial: {
+          '1000-1500': 240,
+          '1500-2000': 285,
+          '2000-2500': 330,
+          '2500-3000': 380,
+          '3000-3500': 425,
+          '3500-4000': 470
+        },
+        office: {
+          '1000-1500': 210,
+          '1500-2000': 250,
+          '2000-2500': 295,
+          '2500-3000': 335,
+          '3000-3500': 375,
+          '3500-4000': 420
+        }
+      };
 
-      document.addEventListener('click', (e)=>{
-        if(e.target.matches('.next')){
-          const vis = steps[current];
-          const req = vis.querySelectorAll('[required]');
-          for (const el of req){ if(!el.value){ el.focus(); return; } }
-          showStep(Math.min(current+1, steps.length-1));
+      const detailPricing = {
+        home: {
+          rooms: { '1-2': 0, '3-4': 25, '5-6': 55, '7+': 85 },
+          bathrooms: { '1': 0, '2': 18, '3': 36, '4+': 54 },
+          pets: { no: 0, yes: 25 }
+        },
+        office: {
+          offices: { '1-5': 0, '6-10': 45, '11-20': 90, '21+': 135 },
+          bathrooms: { '1-2': 0, '3-4': 40, '5+': 70 }
         }
-        if(e.target.matches('.back')){
-          showStep(Math.max(current-1, 0));
+      };
+
+      quoteForms.forEach(setupQuoteForm);
+
+      function setupQuoteForm(form){
+        const requiredFields = Array.from(form.querySelectorAll('[data-required]'));
+        const basePriceEl = form.querySelector('[data-quote-base]');
+        const detailRow = form.querySelector('[data-quote-detail-row]');
+        const detailPriceEl = form.querySelector('[data-quote-detail]');
+        const totalPriceEl = form.querySelector('[data-quote-total]');
+        const serviceInput = form.querySelector('input[name="service"]');
+        const sqftInput = form.querySelector('input[name="square-footage"]');
+        const serviceDetailsWrapper = form.querySelector('.service-details');
+        const detailGroups = serviceDetailsWrapper ? Array.from(serviceDetailsWrapper.querySelectorAll('[data-service-detail]')) : [];
+        const seePriceBtn = form.querySelector('.quote-see-price');
+        const pillControls = Array.from(form.querySelectorAll('[data-target-input]'));
+
+        function fieldIsRelevant(field){
+          const requirement = field.dataset.serviceRequired;
+          if(!requirement) return true;
+          const serviceKey = serviceInput ? serviceInput.value : '';
+          if(!serviceKey) return false;
+          return requirement.split(',').includes(serviceKey);
         }
-      });
 
-      form.addEventListener('submit', (e)=>{
-        e.preventDefault();
-        // Let Formspree submit normally:
-        form.submit();
-        // If you prefer the inline success card instead, uncomment below:
-        // form.hidden = true;
-        // document.getElementById('bookingSuccess').hidden = false;
-      });
+        function hasAllRequired(){
+          return requiredFields.every(field => {
+            if(!fieldIsRelevant(field)) return true;
+            const value = field.value ? field.value.trim() : '';
+            if(field.type === 'email'){
+              return value !== '' && value.includes('@');
+            }
+            return value !== '';
+          });
+        }
 
-      // package descriptions toggle
-      const pkg = document.getElementById('package');
-      function updatePkg(){
-        const blocks = {
-          industrial: document.getElementById('pkg-industrial'),
-          office: document.getElementById('pkg-office'),
-          specialty: document.getElementById('pkg-specialty')
-        };
-        Object.values(blocks).forEach(b=> b.hidden = true);
-        if (blocks[pkg.value]) blocks[pkg.value].hidden = false;
-      }
-      if(pkg){ pkg.addEventListener('change', updatePkg); }
+        function resetServiceGroup(group){
+          const hiddenInputs = Array.from(group.querySelectorAll('input[type="hidden"]'));
+          hiddenInputs.forEach(input => {
+            input.value = '';
+            input.dataset.label = '';
+          });
+          const buttons = Array.from(group.querySelectorAll('[data-target-input]'));
+          buttons.forEach(btn => {
+            btn.classList.remove('active');
+            btn.setAttribute('aria-pressed', 'false');
+          });
+        }
 
-      // Build the review summary
-      function buildReview(){
-        const fd = new FormData(form);
-        const freqMap = {
-          weekly: 'Weekly (25% off)',
-          biweekly: 'Bi-Weekly (20% off)',
-          triweekly: 'Tri-Weekly (15% off)',
-          monthly: 'Monthly (10% off)',
-          biannual: 'Biannual (5% off)',
-          onetime: 'One-time'
-        };
-        const pkgMap = {
-          industrial: 'üè≠ Industrial & Warehouse Care',
-          office: 'üñ•Ô∏è Office & Corporate Cleaning',
-          specialty: 'ü™ü Specialty Facility Services'
-        };
+        function updateServiceDetails(serviceKey){
+          if(!serviceDetailsWrapper) return;
+          let activeCount = 0;
+          detailGroups.forEach(group => {
+            const services = (group.dataset.serviceDetail || '').split(',');
+            const match = serviceKey && services.includes(serviceKey);
+            group.classList.toggle('active', !!match);
+            group.setAttribute('aria-hidden', match ? 'false' : 'true');
+            if(match){
+              activeCount += 1;
+            } else {
+              resetServiceGroup(group);
+            }
+          });
+          serviceDetailsWrapper.classList.toggle('visible', activeCount > 0);
+          serviceDetailsWrapper.setAttribute('aria-hidden', activeCount > 0 ? 'false' : 'true');
+        }
 
-        const rows = [
-          ['Business', fd.get('business') || '‚Äî'],
-          ['Address', [fd.get('address'), fd.get('city'), fd.get('postal')].filter(Boolean).join(', ') || '‚Äî'],
-          ['Preferred Date', fd.get('date') || '‚Äî'],
-          ['Preferred Time', fd.get('time') || '‚Äî'],
-          ['Approx. Sq Ft', fd.get('sqft') || '‚Äî'],
-          ['Frequency', freqMap[fd.get('frequency')] || '‚Äî'],
-          ['Package', pkgMap[fd.get('package')] || '‚Äî'],
-          ['Full Name', fd.get('name') || '‚Äî'],
-          ['Email', fd.get('email') || '‚Äî'],
-          ['Phone', fd.get('phone') || '‚Äî'],
-          ['Notes', (fd.get('notes') || '‚Äî')]
-        ];
+        function selectionInfo(input){
+          if(!input || !input.value) return null;
+          return {
+            value: input.value,
+            label: input.dataset.label || input.value
+          };
+        }
 
-        reviewList.innerHTML = rows.map(([k,v])=> `<dt>${k}</dt><dd>${String(v).replace(/</g,'&lt;')}</dd>`).join('');
-      }
+        function calculateTotals(){
+          const serviceKey = serviceInput ? serviceInput.value : '';
+          const sqftKey = sqftInput ? sqftInput.value : '';
+          if(!serviceKey || !sqftKey || !basePricing[serviceKey]){
+            return { ready: false, base: 0, detail: 0, total: 0, selections: {}, serviceLabel: '', sqftLabel: '' };
+          }
 
-      // init
-      showStep(0);
-    })();
-  </script>
+          const base = basePricing[serviceKey][sqftKey] || 0;
+          let detailAdjustment = 0;
+          const selections = {};
 
-  <!-- OPTIONAL: Google Places Autocomplete (shows "Powered by Google" automatically)
-       Replace YOUR_API_KEY_HERE with your Maps JavaScript API key with Places enabled.
-       If you skip this, the form still works‚Äîthis block is optional. -->
-  <script>
-    (function attachPlaces(){
-      window.initPlaces = function(){
-        if (!window.google || !google.maps || !google.maps.places) return;
-        const addr = document.getElementById('address');
-        if (!addr) return;
-        const ac = new google.maps.places.Autocomplete(addr, {
-          types: ['address'],
-          fields: ['address_components','formatted_address']
-        });
-        ac.addListener('place_changed', () => {
-          const p = ac.getPlace();
-          if (!p || !p.address_components) return;
-          const cityEl = document.getElementById('city');
-          const postalEl = document.getElementById('postal');
-          const comps = p.address_components;
-
-          const get = (type) => (comps.find(c => c.types.includes(type)) || {}).long_name || '';
-          const city = get('locality') || get('postal_town') || get('administrative_area_level_3') || '';
-          const postal = get('postal_code') || '';
-
-          if (city && cityEl) cityEl.value = city;
-          if (postal && postalEl) postalEl.value = postal;
-        });
-      };
+          if(serviceKey === 'home'){
+            const roomsField = form.querySelector('input[name="home-rooms"]');
+            const bathsField = form.querySelector('input[name="home-bathrooms"]');
+            const petsField = form.querySelector('input[name="home-pets"]');
 
-      // If developer adds the script later, this still works.
-      // (Do nothing if script isn't present yet.)
-    })();
-  </script>
-  <!-- If you want Places now, uncomment the next line and insert your key:
-  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY_HERE&libraries=places&callback=initPlaces" async defer></script>
-  -->
-</body>
-</html>
-<!-- BOOKING FORM -->
-<form id="bookingForm"
-      action="https://formspree.io/f/mrblyqpr"
-      method="POST"
-      novalidate>
-
-  <!-- hidden meta sent to Formspree -->
-  <input type="hidden" name="_subject" value="New Booking ‚Äî DufferinDeepClean">
-  <!-- optional: redirect after success (change URL if you have a thank-you page) -->
-  <input type="hidden" name="_redirect" value="https://dufferindeepclean.ca/thank-you.html">
-  <input type="hidden" name="page" value="book.html">
-
-  <!-- STEP 1 ‚Äî when & where -->
-  <section class="step" data-step="1">
-    <input name="date" type="date" required>
-    <input name="time" type="time" required>
-    <input name="address" type="text" placeholder="Street address" required>
-    <button type="button" class="next">Next</button>
-  </section>
+            const roomsInfo = selectionInfo(roomsField);
+            const bathsInfo = selectionInfo(bathsField);
+            const petsInfo = selectionInfo(petsField);
 
-  <!-- STEP 2 ‚Äî how often -->
-  <section class="step" data-step="2" hidden>
-    <select name="frequency" required>
-      <option value="">Select frequency</option>
-      <option>One-time</option>
-      <option>Weekly (25% off)</option>
-      <option>Bi-Weekly (20% off)</option>
-      <option>Monthly (10% off)</option>
-      <option>Biannual</option>
-    </select>
-    <div class="nav">
-      <button type="button" class="back">Back</button>
-      <button type="button" class="next">Next</button>
-    </div>
-  </section>
+            if(roomsInfo){
+              detailAdjustment += detailPricing.home.rooms[roomsInfo.value] || 0;
+              selections.homeRooms = roomsInfo;
+            }
+            if(bathsInfo){
+              detailAdjustment += detailPricing.home.bathrooms[bathsInfo.value] || 0;
+              selections.homeBathrooms = bathsInfo;
+            }
+            if(petsInfo){
+              detailAdjustment += detailPricing.home.pets[petsInfo.value] || 0;
+              selections.homePets = petsInfo;
+            }
+          }
 
-  <!-- STEP 3 ‚Äî cleaning type -->
-  <section class="step" data-step="3" hidden>
-    <select name="package" required>
-      <option value="">Select a package</option>
-      <option>Specialty Facility Services</option>
-      <option>Office Basic</option>
-      <option>Deep Clean</option>
-    </select>
-    <div class="nav">
-      <button type="button" class="back">Back</button>
-      <button type="button" class="next">Next</button>
-    </div>
-  </section>
+          if(serviceKey === 'office'){
+            const officesField = form.querySelector('input[name="office-offices"]');
+            const officeBathsField = form.querySelector('input[name="office-bathrooms"]');
 
-  <!-- STEP 4 ‚Äî your details -->
-  <section class="step" data-step="4" hidden>
-    <input name="full_name" type="text" placeholder="Full name" required>
-    <input name="email" type="email" placeholder="Email" required>
-    <input name="phone" type="tel" placeholder="Phone" required>
-    <textarea name="notes" placeholder="Anything we should know?"></textarea>
-    <div class="nav">
-      <button type="button" class="back">Back</button>
-      <button type="button" class="next">Next</button>
-    </div>
-  </section>
+            const officesInfo = selectionInfo(officesField);
+            const officeBathsInfo = selectionInfo(officeBathsField);
 
-  <!-- STEP 5 ‚Äî review & confirm -->
-  <section class="step" data-step="5" hidden>
-    <!-- Optional: render a summary here -->
-    <label class="agree">
-      <input type="checkbox" name="agree" required>
-      I agree to the terms and confirm the details are correct.
-    </label>
-
-    <div class="nav">
-      <button type="button" class="back">Back</button>
-      <!-- IMPORTANT: this must be type="submit" -->
-      <button type="submit" id="submitBtn">Submit</button>
-    </div>
-  </section>
+            if(officesInfo){
+              detailAdjustment += detailPricing.office.offices[officesInfo.value] || 0;
+              selections.officeOffices = officesInfo;
+            }
+            if(officeBathsInfo){
+              detailAdjustment += detailPricing.office.bathrooms[officeBathsInfo.value] || 0;
+              selections.officeBathrooms = officeBathsInfo;
+            }
+          }
 
-  <!-- inline status messages -->
-  <p id="formStatus" role="status" aria-live="polite" style="display:none;"></p>
-</form>
-
-<script>
-(function() {
-  const steps = [...document.querySelectorAll('.step')];
-  let i = 0;
-  const show = (n) => {
-    steps.forEach((s, idx) => s.hidden = idx !== n);
-    i = n;
-  };
-
-  document.addEventListener('click', (e) => {
-    if (e.target.classList.contains('next')) {
-      const current = steps[i];
-      // simple validation: ensure current step's required inputs are filled
-      const required = current.querySelectorAll('[required]');
-      for (const field of required) {
-        if (!field.checkValidity()) { field.reportValidity(); return; }
-      }
-      show(Math.min(i + 1, steps.length - 1));
-    }
-    if (e.target.classList.contains('back')) show(Math.max(i - 1, 0));
-  });
-
-  // Ajax submit so you can stay on the page and show a message
-  const form = document.getElementById('bookingForm');
-  const status = document.getElementById('formStatus');
-
-  form.addEventListener('submit', async (e) => {
-    e.preventDefault(); // prevent page reload
-
-    // Final validation across the whole form
-    if (!form.checkValidity()) {
-      // report the first invalid input
-      const firstInvalid = form.querySelector(':invalid');
-      if (firstInvalid) firstInvalid.reportValidity();
-      return;
-    }
-
-    const data = new FormData(form);
-    try {
-      const resp = await fetch(form.action, {
-        method: 'POST',
-        body: data,
-        headers: { 'Accept': 'application/json' }
-      });
+          return {
+            ready: true,
+            base,
+            detail: detailAdjustment,
+            total: base + detailAdjustment,
+            selections,
+            serviceLabel: serviceInput?.dataset.label || serviceKey,
+            sqftLabel: sqftInput?.dataset.label || sqftKey
+          };
+        }
 
-      if (resp.ok) {
-        status.style.display = 'block';
-        status.textContent = 'Thanks! Your booking request was sent. We‚Äôll email you shortly.';
-        form.reset();
-        show(0); // go back to step 1
-      } else {
-        const err = await resp.json().catch(() => ({}));
-        throw new Error(err.errors?.map(e => e.message).join(', ') || 'Submission failed.');
-      }
-    } catch (err) {
-      status.style.display = 'block';
-      status.textContent = 'Sorry, we could not submit the form. Please try again or email us.';
-      console.error(err);
-    }
-  });
+        function formatCurrency(value){
+          if(!value) return '‚Äî';
+          return `$${Math.round(value)}`;
+        }
+
+        function updateTotals(){
+          const totals = calculateTotals();
+
+          if(basePriceEl){ basePriceEl.textContent = totals.ready ? formatCurrency(totals.base) : '‚Äî'; }
+          if(totalPriceEl){ totalPriceEl.textContent = totals.ready ? formatCurrency(totals.total) : '‚Äî'; }
 
-  // start on step 1
-  show(0);
-})();
-</script>
+          if(detailRow && detailPriceEl){
+            if(totals.ready && totals.detail > 0){
+              detailRow.hidden = false;
+              detailPriceEl.textContent = `+$${Math.round(totals.detail)}`;
+            } else {
+              detailRow.hidden = true;
+              detailPriceEl.textContent = '‚Äî';
+            }
+          }
+
+          const ready = totals.ready && hasAllRequired();
+          form.classList.toggle('quote-ready', ready);
+          if(seePriceBtn){ seePriceBtn.disabled = !ready; }
+
+          return totals;
+        }
+
+        pillControls.forEach(control => {
+          const targetName = control.dataset.targetInput;
+          if(!targetName) return;
+          const hiddenInput = form.querySelector(`input[name="${targetName}"]`);
+          if(!hiddenInput) return;
+
+          control.setAttribute('aria-pressed', 'false');
+
+          control.addEventListener('click', () => {
+            const group = control.closest('[role="radiogroup"]') || control.parentElement;
+            if(group){
+              Array.from(group.querySelectorAll('[data-target-input="' + targetName + '"]')).forEach(btn => {
+                const active = btn === control;
+                btn.classList.toggle('active', active);
+                btn.setAttribute('aria-pressed', active ? 'true' : 'false');
+              });
+            }
+
+            hiddenInput.value = control.dataset.value || '';
+            hiddenInput.dataset.label = control.dataset.label || hiddenInput.value;
+            hiddenInput.dispatchEvent(new Event('change', { bubbles: true }));
+            updateServiceDetails(serviceInput ? serviceInput.value : '');
+            updateTotals();
+          });
+        });
+
+        requiredFields.forEach(field => {
+          const eventName = field.tagName === 'SELECT' ? 'change' : 'input';
+          field.addEventListener(eventName, updateTotals);
+        });
+
+        if(serviceInput){
+          serviceInput.addEventListener('change', () => {
+            updateServiceDetails(serviceInput.value);
+            updateTotals();
+          });
+        }
+
+        if(sqftInput){
+          sqftInput.addEventListener('change', updateTotals);
+        }
+
+        if(seePriceBtn){
+          seePriceBtn.addEventListener('click', () => {
+            if(seePriceBtn.disabled) return;
+            const totals = updateTotals();
+            if(!totals.ready) return;
+
+            const mode = form.dataset.quoteMode || 'redirect';
+            if(mode !== 'redirect') return;
+
+            const redirectTarget = form.dataset.redirect || 'book.html';
+            const url = new URL(redirectTarget, window.location.origin);
+            const params = url.searchParams;
+
+            const serviceValue = serviceInput ? serviceInput.value : '';
+            if(serviceValue){
+              params.set('service', serviceValue);
+              if(totals.serviceLabel){ params.set('serviceLabel', totals.serviceLabel); }
+            }
+
+            const sqftValue = sqftInput ? sqftInput.value : '';
+            if(sqftValue){
+              params.set('sqft', sqftValue);
+              if(totals.sqftLabel){ params.set('sqftLabel', totals.sqftLabel); }
+            }
+
+            params.set('basePrice', totals.base.toFixed(2));
+            params.set('detailPrice', totals.detail.toFixed(2));
+            params.set('total', totals.total.toFixed(2));
+
+            const firstName = form.querySelector('input[name="first-name"]');
+            if(firstName && firstName.value.trim()){
+              params.set('firstName', firstName.value.trim());
+            }
+
+            const email = form.querySelector('input[name="email"]');
+            if(email && email.value.trim()){
+              params.set('email', email.value.trim());
+            }
+
+            Object.entries(totals.selections || {}).forEach(([key, info]) => {
+              if(info.value){ params.set(key, info.value); }
+              if(info.label){ params.set(`${key}Label`, info.label); }
+            });
+
+            const anchor = form.dataset.redirectAnchor;
+            const finalUrl = anchor ? `${url.toString()}#${anchor}` : url.toString();
+            window.location.href = finalUrl;
+          });
+        }
+
+        updateServiceDetails(serviceInput ? serviceInput.value : '');
+        updateTotals();
+      }
+    })();
+  </script>
+
+  <script>
+    (function(){
+      const form = document.getElementById('bookingForm');
+      if(!form) return;
+
+      const steps = Array.from(form.querySelectorAll('.step'));
+      const stepper = Array.from(document.getElementById('stepper').children || []);
+      const reviewList = document.getElementById('reviewList');
+      const successEl = document.getElementById('bookingSuccess');
+      const layoutEl = document.getElementById('bookingLayout');
+
+      const addonEmptyMessage = document.getElementById('addon-empty-message');
+
+      const hiddenServiceKey = document.getElementById('input-service-key');
+      const hiddenServiceLabel = document.getElementById('input-service-label');
+      const hiddenSqftLabel = document.getElementById('input-sqft-label');
+      const hiddenDetailSummary = document.getElementById('input-detail-summary');
+      const hiddenBasePrice = document.getElementById('input-base-price');
+      const hiddenDetailPrice = document.getElementById('input-detail-price');
+      const hiddenAddonsPrice = document.getElementById('input-addons-price');
+      const hiddenDiscountPrice = document.getElementById('input-discount-price');
+      const hiddenDepositPrice = document.getElementById('input-deposit-price');
+      const hiddenBalancePrice = document.getElementById('input-balance-price');
+      const hiddenTotalPrice = document.getElementById('input-total-price');
+      const hiddenSelectedAddons = document.getElementById('input-selected-addons');
+      const hiddenPackage = document.getElementById('input-package');
+      const hiddenPayPalOrder = document.getElementById('input-paypal-order-id');
+      const hiddenPayPalPayer = document.getElementById('input-paypal-payer-id');
+      const hiddenPayPalCapture = document.getElementById('input-paypal-capture-id');
+      const hiddenCartStatus = document.getElementById('input-cart-status');
+      const DEFAULT_CART_IMAGE = './deepcleanpackage.png';
+      const currencyFormatter = (typeof Intl !== 'undefined' && typeof Intl.NumberFormat === 'function')
+        ? new Intl.NumberFormat('en-CA', { style: 'currency', currency: 'CAD', maximumFractionDigits: 0 })
+        : null;
+      const CART_IMAGE_DATA_URI = (window.CART_IMAGE_DATA_URI && typeof window.CART_IMAGE_DATA_URI === 'string' && window.CART_IMAGE_DATA_URI.trim()) ? window.CART_IMAGE_DATA_URI.trim() : '';
+      if(!window.CART_IMAGE_DATA_URI){
+        window.CART_IMAGE_DATA_URI = CART_IMAGE_DATA_URI;
+      }
+      const resolveCartImagePath = () => {
+        const candidates = [];
+        if(window.CART_IMAGE_PATH && typeof window.CART_IMAGE_PATH === 'string'){
+          candidates.push(window.CART_IMAGE_PATH);
+        }
+        if(document.body && document.body.dataset && typeof document.body.dataset.cartImage === 'string'){
+          candidates.push(document.body.dataset.cartImage);
+        }
+        candidates.push(DEFAULT_CART_IMAGE);
+        for(const candidate of candidates){
+          if(candidate && typeof candidate === 'string' && candidate.trim()){
+            return candidate.trim();
+          }
+        }
+        return CART_IMAGE_DATA_URI || DEFAULT_CART_IMAGE;
+      };
+      const CART_IMAGE_PATH = resolveCartImagePath();
+      if(!window.CART_IMAGE_PATH){
+        window.CART_IMAGE_PATH = CART_IMAGE_PATH;
+      }
+      const cartImage = document.getElementById('cartSummaryImage');
+      if(cartImage && !cartImage.getAttribute('src')){
+        const fallback = CART_IMAGE_DATA_URI || DEFAULT_CART_IMAGE;
+        const targetSrc = CART_IMAGE_PATH || fallback;
+        const shouldListen = fallback && targetSrc !== fallback;
+        const handleImageError = () => {
+          cartImage.removeEventListener('error', handleImageError);
+          cartImage.src = fallback;
+        };
+        if(shouldListen){
+          cartImage.addEventListener('error', handleImageError);
+        }
+        cartImage.src = targetSrc;
+      }
+      const hiddenFullName = document.getElementById('input-full-name');
+      const originField = document.getElementById('input-origin');
+
+      const depositText = document.getElementById('deposit-due-text');
+      const balanceText = document.getElementById('balance-due-text');
+      const submitBtn = form.querySelector('.submit');
+
+      const recapBase = document.querySelector('[data-recap-base]');
+      const recapDetailRow = document.querySelector('[data-recap-detail-row]');
+      const recapDetail = document.querySelector('[data-recap-detail]');
+      const recapExtrasRow = document.querySelector('[data-recap-extras-row]');
+      const recapExtras = document.querySelector('[data-recap-extras]');
+      const recapDiscountRow = document.querySelector('[data-recap-discount-row]');
+      const recapDiscount = document.querySelector('[data-recap-discount]');
+      const recapTotal = document.querySelector('[data-recap-total]');
+      const recapDescription = document.querySelector('[data-cart-description]');
+      const cartService = document.querySelector('[data-cart-service]');
+      const addToCartBtn = document.getElementById('addToCartBtn');
+      const cartStatus = document.getElementById('cartStatus');
+      const cartSummaryEl = document.getElementById('cartSummary');
+      const formColumnsEl = document.querySelector('.form-columns');
+      const navCartButton = document.querySelector('[data-cart-toggle]');
+      const navPayPalContainer = document.getElementById('nav-paypal-buttons');
+      const navPayPalStatus = document.getElementById('nav-paypal-status');
+
+      const frequencyInputs = Array.from(form.querySelectorAll('input[name="frequency"]'));
+      const addonGroups = Array.from(form.querySelectorAll('.addon-group'));
+      const addonPills = Array.from(form.querySelectorAll('.addon-pill'));
+
+      const escapeHtml = (value) => String(value)
+        .replace(/&/g, '&amp;')
+        .replace(/</g, '&lt;')
+        .replace(/>/g, '&gt;')
+        .replace(/"/g, '&quot;')
+        .replace(/'/g, '&#39;');
+
+      const ADDON_ICON_SVGS = {
+        sparkle: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M16 5l2.2 5.8 6 .4-4.7 4 1.4 5.7-4.9-3.1-4.9 3.1 1.4-5.7-4.7-4 6-.4z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M9.2 9.5l1.1 2.3 2.5.2-2 1.7.6 2.3-2.1-1.3-2.1 1.3.6-2.3-2-1.7 2.5-.2z" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linejoin="round" opacity=".6"/></svg>`,
+        truck: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M5 12h12v9H7a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M17 12h5l3 4v5h-4" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><circle cx="11.5" cy="23" r="2.4" fill="none" stroke="currentColor" stroke-width="1.6"/><circle cx="23.5" cy="23" r="2.4" fill="none" stroke="currentColor" stroke-width="1.6"/><path d="M9 12V8.5A2.5 2.5 0 0 1 11.5 6H15" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`,
+        tool: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M19 6.5a4 4 0 0 0-5.4 5.4l-6.1 6.1 2.3 2.3 6.1-6.1a4 4 0 0 0 5.4-5.4l3.7-3.2" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><path d="M13.8 14.2l7.5 7.5" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><circle cx="23.5" cy="8.5" r="2.5" fill="none" stroke="currentColor" stroke-width="1.6"/></svg>`,
+        cap: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M4 12l12-5 12 5-12 5-12-5z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M10 16v4.5c0 2.2 2.7 3.5 6 3.5s6-1.3 6-3.5V16" fill="none" stroke="currentColor" stroke-width="1.6"/><path d="M26 13.5v7" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`,
+        home: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M6 14l10-8 10 8v12H6V14z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M13 26v-7h6v7" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/></svg>`,
+        paw: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><circle cx="10" cy="12" r="2.2" fill="none" stroke="currentColor" stroke-width="1.4"/><circle cx="16" cy="10" r="2.4" fill="none" stroke="currentColor" stroke-width="1.4"/><circle cx="22" cy="12" r="2.2" fill="none" stroke="currentColor" stroke-width="1.4"/><path d="M11 19c0-3 2.7-5 5-5s5 2 5 5-2.2 6-5 6-5-3-5-6z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/></svg>`,
+        fridge: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><rect x="9" y="5" width="14" height="22" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="1.6"/><line x1="9" y1="15" x2="23" y2="15" stroke="currentColor" stroke-width="1.6"/><line x1="12.5" y1="11" x2="12.5" y2="13" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`,
+        oven: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><rect x="7" y="7" width="18" height="20" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="1.6"/><rect x="10" y="13" width="12" height="9" rx="1.5" fill="none" stroke="currentColor" stroke-width="1.6"/><circle cx="11" cy="10" r="1" fill="currentColor"/><circle cx="16" cy="10" r="1" fill="currentColor"/><circle cx="21" cy="10" r="1" fill="currentColor"/></svg>`,
+        cabinet: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><rect x="8" y="7" width="16" height="18" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="1.6"/><line x1="8" y1="15" x2="24" y2="15" stroke="currentColor" stroke-width="1.6"/><line x1="8" y1="21" x2="24" y2="21" stroke="currentColor" stroke-width="1.6"/><circle cx="16" cy="12" r="0.9" fill="currentColor"/><circle cx="16" cy="18" r="0.9" fill="currentColor"/><circle cx="16" cy="24" r="0.9" fill="currentColor"/></svg>`,
+        utensils: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M10 5v8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M8 5v4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M12 5v4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M21 13v14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M8 13v14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M12 13v14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M18 5a3 3 0 0 1 3 3v5.5" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`,
+        blinds: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><rect x="7" y="7" width="18" height="18" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="1.6"/><line x1="9" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><line x1="9" y1="16" x2="23" y2="16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><line x1="9" y1="20" x2="23" y2="20" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M16 25v3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`,
+        window: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><rect x="7" y="7" width="18" height="18" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="1.6"/><line x1="16" y1="7" x2="16" y2="25" stroke="currentColor" stroke-width="1.6"/><line x1="7" y1="16" x2="25" y2="16" stroke="currentColor" stroke-width="1.6"/></svg>`,
+        bed: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M7 14h18a3 3 0 0 1 3 3v9H4v-9a3 3 0 0 1 3-3z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M10 14V9a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v5" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/></svg>`,
+        dish: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><circle cx="16" cy="16" r="9" fill="none" stroke="currentColor" stroke-width="1.6"/><circle cx="16" cy="16" r="4" fill="none" stroke="currentColor" stroke-width="1.6"/><path d="M24 6v5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`,
+        spray: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M13 6h6l2 3h-6l-2-3z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M14 9h8l-2 4v11a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2V13l2-4z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><circle cx="23" cy="7" r="1.2" fill="currentColor"/><circle cx="25.5" cy="7.5" r="0.9" fill="currentColor" opacity=".6"/></svg>`,
+        vacuum: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M18 10l4-4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M18 22V10a3 3 0 0 0-3-3h-3" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M10 24a6 6 0 0 1 12 0" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M16 24v4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M12 24H8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M20 24h4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`,
+        tiles: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><rect x="7" y="7" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.6"/><line x1="13" y1="7" x2="13" y2="25" stroke="currentColor" stroke-width="1.6"/><line x1="19" y1="7" x2="19" y2="25" stroke="currentColor" stroke-width="1.6"/><line x1="7" y1="13" x2="25" y2="13" stroke="currentColor" stroke-width="1.6"/><line x1="7" y1="19" x2="25" y2="19" stroke="currentColor" stroke-width="1.6"/></svg>`,
+        squeegee: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M7 10h18l-2 6H9l-2-6z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M16 16v10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M13 26h6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`,
+        pressure: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><path d="M8 20h9a3 3 0 0 1 3 3v4" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M14 20V10l4-2 2 3v4" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M22 9l4-2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M22 11l4 1" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M21 13l3.5 2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" opacity=".7"/></svg>`,
+        floor: `<svg viewBox="0 0 32 32" aria-hidden="true" focusable="false"><circle cx="16" cy="22" r="6" fill="none" stroke="currentColor" stroke-width="1.6"/><path d="M16 22l6-14" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M20 6h4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M21 9h3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`
+      };
+
+      addonPills.forEach(pill => {
+        const iconSpan = pill.querySelector('.addon-icon[data-icon]');
+        if(iconSpan){
+          const key = iconSpan.dataset.icon || '';
+          if(ADDON_ICON_SVGS[key]){
+            iconSpan.innerHTML = ADDON_ICON_SVGS[key];
+          }
+        }
+      });
+      const paymentRadios = Array.from(form.querySelectorAll('input[name="payment_method"]'));
+      const paypalUi = document.querySelector('[data-payment-ui="paypal"]');
+      const paypalButtonsContainer = document.getElementById('paypal-buttons');
+      const paypalStatus = document.getElementById('paypal-status');
+      const PAYPAL_CONTEXTS = {};
+      if(paypalButtonsContainer){
+        PAYPAL_CONTEXTS.main = { container: paypalButtonsContainer, status: paypalStatus };
+      }
+      if(navPayPalContainer){
+        PAYPAL_CONTEXTS.nav = { container: navPayPalContainer, status: navPayPalStatus };
+      }
+
+      const DEPOSIT_RATE = 0.5;
+      const PAYPAL_CURRENCY = ((document.body && document.body.dataset && document.body.dataset.paypalCurrency) || 'CAD').toUpperCase();
+      const FREQUENCY_LABELS = {
+        weekly: 'Weekly (25% off)',
+        biweekly: 'Bi-Weekly (20% off)',
+        triweekly: 'Tri-Weekly (15% off)',
+        monthly: 'Monthly (10% off)',
+        biannual: 'Biannual (5% off)',
+        onetime: 'One-time'
+      };
+
+      const paypalButtonsInstances = {};
+      let paypalApproved = false;
+      let paypalApprovedAmount = 0;
+      let paypalScriptPromise = null;
+      let current = 0;
+      stepper.forEach((item, idx) => {
+        item.dataset.stepIndex = String(idx);
+        item.setAttribute('role', 'button');
+        item.tabIndex = idx === 0 ? 0 : -1;
+        item.setAttribute('aria-disabled', idx === 0 ? 'false' : 'true');
+        item.addEventListener('click', () => {
+          if(idx <= current){
+            showStep(idx);
+          }
+        });
+        item.addEventListener('keydown', (event) => {
+          if((event.key === 'Enter' || event.key === ' ') && idx <= current){
+            event.preventDefault();
+            showStep(idx);
+          }
+        });
+      });
+      let cartAdded = false;
+      let autoAddAfterSkip = false;
+      let lastCartSignature = '';
+      let latestCartState = null;
+      let quoteAvailable = false;
+
+      const params = new URLSearchParams(window.location.search);
+      const QUOTE_STORAGE_KEY = 'ddcQuotePayload';
+
+      function parseAmount(value){
+        if(typeof value === 'number'){
+          return Number.isFinite(value) ? value : 0;
+        }
+        if(typeof value === 'string'){
+          const trimmed = value.trim();
+          if(!trimmed) return 0;
+          const num = Number(trimmed);
+          return Number.isFinite(num) ? num : 0;
+        }
+        return 0;
+      }
+
+      function safeParseJson(value){
+        if(!value) return null;
+        try {
+          return JSON.parse(value);
+        } catch(_){
+          return null;
+        }
+      }
+
+      let storedQuote = null;
+      try {
+        if(window.sessionStorage){
+          storedQuote = safeParseJson(sessionStorage.getItem(QUOTE_STORAGE_KEY));
+        }
+      } catch(_){
+        storedQuote = null;
+      }
+
+      const storedSelections = storedQuote && typeof storedQuote.selections === 'object' && storedQuote.selections
+        ? storedQuote.selections
+        : {};
+      const SERVICE_LABELS = {
+        home: 'Home General Cleaning',
+        commercial: 'Factory / Commercial / Industrial Cleaning',
+        office: 'Office Workspace Cleaning'
+      };
+      const BASE_PRICE_TABLE = {
+        home: {
+          '1000-1500': 165,
+          '1500-2000': 185,
+          '2000-2500': 215,
+          '2500-3000': 245,
+          '3000-3500': 285,
+          '3500-4000': 325
+        },
+        commercial: {
+          '1000-1500': 240,
+          '1500-2000': 285,
+          '2000-2500': 330,
+          '2500-3000': 380,
+          '3000-3500': 425,
+          '3500-4000': 470
+        },
+        office: {
+          '1000-1500': 210,
+          '1500-2000': 250,
+          '2000-2500': 295,
+          '2500-3000': 335,
+          '3000-3500': 375,
+          '3500-4000': 420
+        }
+      };
+      const DETAIL_PRICE_TABLE = {
+        home: {
+          rooms: { '1-2': 0, '3-4': 25, '5-6': 55, '7+': 85 },
+          bathrooms: { '1': 0, '2': 18, '3': 36, '4+': 54 },
+          pets: { no: 0, yes: 25 },
+          basement: { no: 0, yes: 45 },
+          basementRooms: { '1-2': 25, '3-4': 45, '5+': 65 },
+          basementBathrooms: { '1': 18, '2': 32, '3+': 46 }
+        },
+        office: {
+          offices: { '1-5': 0, '6-10': 45, '11-20': 90, '21+': 135 },
+          bathrooms: { '1-2': 0, '3-4': 40, '5+': 70 }
+        }
+      };
+
+      let serviceKey = params.get('service') || '';
+      let rawServiceLabel = params.get('serviceLabel') || '';
+      let sqftKey = params.get('sqft') || '';
+      let rawSqftLabel = params.get('sqftLabel') || '';
+      const rawBaseParam = params.get('basePrice');
+      const rawDetailParam = params.get('detailPrice');
+      let totalParam = parseAmount(params.get('total'));
+      let basePrice = parseAmount(rawBaseParam);
+      let detailPrice = parseAmount(rawDetailParam);
+      let totalBase = 0;
+
+      if(!serviceKey && storedQuote && storedQuote.service){
+        serviceKey = storedQuote.service;
+      }
+      if(!rawServiceLabel && storedQuote && storedQuote.serviceLabel){
+        rawServiceLabel = storedQuote.serviceLabel;
+      }
+      if(!sqftKey && storedQuote && storedQuote.sqft){
+        sqftKey = storedQuote.sqft;
+      }
+      if(!rawSqftLabel && storedQuote && storedQuote.sqftLabel){
+        rawSqftLabel = storedQuote.sqftLabel;
+      }
+      if(!(basePrice > 0) && storedQuote && parseAmount(storedQuote.basePrice) > 0){
+        basePrice = parseAmount(storedQuote.basePrice);
+      }
+      if(!(detailPrice > 0) && storedQuote && parseAmount(storedQuote.detailPrice) > 0){
+        detailPrice = parseAmount(storedQuote.detailPrice);
+      }
+      if(!(totalParam > 0) && storedQuote && parseAmount(storedQuote.total) > 0){
+        totalParam = parseAmount(storedQuote.total);
+      }
+
+      function formatSqftLabel(label, key){
+        if(label) return label;
+        if(!key) return '';
+        if(key.includes('-')){
+          const parts = key.split('-').map(part => parseInt(part, 10));
+          if(parts.length === 2 && parts.every(num => !Number.isNaN(num))){
+            return `${parts[0].toLocaleString()} ‚Äì ${parts[1].toLocaleString()} sq ft`;
+          }
+        }
+        return key;
+      }
+
+      function selectionValueFromSources(key){
+        const direct = params.get(key);
+        if(direct) return direct;
+        const stored = storedSelections[key];
+        if(stored && stored.value){
+          return stored.value;
+        }
+        return '';
+      }
+
+      function selectionLabelFromSources(key){
+        const labeled = params.get(`${key}Label`);
+        if(labeled) return labeled;
+        const stored = storedSelections[key];
+        if(stored){
+          if(stored.label) return stored.label;
+          if(stored.value) return stored.value;
+        }
+        const fallback = params.get(key);
+        if(fallback) return fallback;
+        return '';
+      }
+
+      function deriveDetailPrice(service){
+        if(service === 'home'){
+          let total = 0;
+          const rooms = Number(selectionValueFromSources('homeRooms') || 0);
+          if(rooms){
+            if(rooms <= 2){ total += DETAIL_PRICE_TABLE.home.rooms['1-2'] || 0; }
+            else if(rooms <= 4){ total += DETAIL_PRICE_TABLE.home.rooms['3-4'] || 0; }
+            else if(rooms <= 6){ total += DETAIL_PRICE_TABLE.home.rooms['5-6'] || 0; }
+            else { total += DETAIL_PRICE_TABLE.home.rooms['7+'] || 0; }
+          }
+          const baths = Number(selectionValueFromSources('homeBathrooms') || 0);
+          if(baths){
+            if(baths <= 1){ total += DETAIL_PRICE_TABLE.home.bathrooms['1'] || 0; }
+            else if(baths <= 2){ total += DETAIL_PRICE_TABLE.home.bathrooms['2'] || 0; }
+            else if(baths <= 3){ total += DETAIL_PRICE_TABLE.home.bathrooms['3'] || 0; }
+            else { total += DETAIL_PRICE_TABLE.home.bathrooms['4+'] || 0; }
+          }
+          const pets = selectionValueFromSources('homePets');
+          if(pets && Object.prototype.hasOwnProperty.call(DETAIL_PRICE_TABLE.home.pets, pets)){
+            total += DETAIL_PRICE_TABLE.home.pets[pets] || 0;
+          }
+          const basement = selectionValueFromSources('homeBasement');
+          if(basement && Object.prototype.hasOwnProperty.call(DETAIL_PRICE_TABLE.home.basement, basement)){
+            total += DETAIL_PRICE_TABLE.home.basement[basement] || 0;
+            if(basement === 'yes'){
+              const basementRooms = Number(selectionValueFromSources('homeBasementRooms') || 0);
+              if(basementRooms){
+                if(basementRooms <= 2){ total += DETAIL_PRICE_TABLE.home.basementRooms['1-2'] || 0; }
+                else if(basementRooms <= 4){ total += DETAIL_PRICE_TABLE.home.basementRooms['3-4'] || 0; }
+                else { total += DETAIL_PRICE_TABLE.home.basementRooms['5+'] || 0; }
+              }
+              const basementBaths = Number(selectionValueFromSources('homeBasementBathrooms') || 0);
+              if(basementBaths){
+                if(basementBaths <= 1){ total += DETAIL_PRICE_TABLE.home.basementBathrooms['1'] || 0; }
+                else if(basementBaths <= 2){ total += DETAIL_PRICE_TABLE.home.basementBathrooms['2'] || 0; }
+                else { total += DETAIL_PRICE_TABLE.home.basementBathrooms['3+'] || 0; }
+              }
+            }
+          }
+          return total;
+        }
+        if(service === 'office'){
+          let total = 0;
+          const officesValue = selectionValueFromSources('officeOffices');
+          if(officesValue){
+            const officesKey = DETAIL_PRICE_TABLE.office.offices[officesValue] !== undefined
+              ? officesValue
+              : (() => {
+                  const count = Number(officesValue);
+                  if(!(count > 0)) return '';
+                  if(count <= 5) return '1-5';
+                  if(count <= 10) return '6-10';
+                  if(count <= 20) return '11-20';
+                  return '21+';
+                })();
+            if(officesKey && DETAIL_PRICE_TABLE.office.offices[officesKey] !== undefined){
+              total += DETAIL_PRICE_TABLE.office.offices[officesKey] || 0;
+            }
+          }
+          const officeBathsValue = selectionValueFromSources('officeBathrooms');
+          if(officeBathsValue){
+            const bathsKey = DETAIL_PRICE_TABLE.office.bathrooms[officeBathsValue] !== undefined
+              ? officeBathsValue
+              : (() => {
+                  const count = Number(officeBathsValue);
+                  if(!(count > 0)) return '';
+                  if(count <= 2) return '1-2';
+                  if(count <= 4) return '3-4';
+                  return '5+';
+                })();
+            if(bathsKey && DETAIL_PRICE_TABLE.office.bathrooms[bathsKey] !== undefined){
+              total += DETAIL_PRICE_TABLE.office.bathrooms[bathsKey] || 0;
+            }
+          }
+          return total;
+        }
+        return 0;
+      }
+
+      if(!(detailPrice > 0)){
+        const derivedDetail = deriveDetailPrice(serviceKey);
+        if(derivedDetail > 0){
+          detailPrice = derivedDetail;
+        }
+      }
+
+      if(!(basePrice > 0) && totalParam > 0){
+        const possibleBase = totalParam - detailPrice;
+        if(possibleBase > 0){
+          basePrice = possibleBase;
+        }
+      }
+
+      if(!(basePrice > 0) && serviceKey && sqftKey && BASE_PRICE_TABLE[serviceKey] && BASE_PRICE_TABLE[serviceKey][sqftKey]){
+        basePrice = BASE_PRICE_TABLE[serviceKey][sqftKey];
+      }
+
+      basePrice = Math.max(0, basePrice);
+      detailPrice = Math.max(0, detailPrice);
+      totalBase = basePrice + detailPrice;
+
+      if(totalParam > 0 && totalParam > totalBase){
+        totalBase = totalParam;
+        if(!(basePrice > 0)){
+          const inferredBase = totalBase - detailPrice;
+          basePrice = inferredBase > 0 ? inferredBase : basePrice;
+        }
+      }
+
+      if(totalBase <= 0 && storedQuote){
+        const storedBase = parseAmount(storedQuote.basePrice);
+        const storedDetail = parseAmount(storedQuote.detailPrice);
+        const storedTotal = parseAmount(storedQuote.total);
+
+        if(!(basePrice > 0) && storedBase > 0){
+          basePrice = storedBase;
+        }
+        if(!(detailPrice > 0) && storedDetail > 0){
+          detailPrice = storedDetail;
+        }
+
+        const recomputed = Math.max(0, basePrice) + Math.max(0, detailPrice);
+        if(recomputed > 0){
+          totalBase = recomputed;
+        }
+
+        if(storedTotal > 0 && storedTotal > totalBase){
+          totalBase = storedTotal;
+          if(!(basePrice > 0)){
+            const fallbackBase = totalBase - detailPrice;
+            basePrice = fallbackBase > 0 ? fallbackBase : basePrice;
+          }
+        }
+      }
+
+      if(totalBase <= 0 && serviceKey && sqftKey && BASE_PRICE_TABLE[serviceKey] && BASE_PRICE_TABLE[serviceKey][sqftKey] > 0){
+        basePrice = BASE_PRICE_TABLE[serviceKey][sqftKey];
+        totalBase = Math.max(0, basePrice) + Math.max(0, detailPrice);
+      }
+
+      quoteAvailable = (basePrice > 0) || (detailPrice > 0) || (totalBase > 0);
+      if(quoteAvailable){
+        totalBase = Math.max(totalBase, Math.max(0, basePrice) + Math.max(0, detailPrice));
+      } else {
+        totalBase = 0;
+      }
+      if(cartSummaryEl){
+        cartSummaryEl.classList.toggle('cart-summary-empty', !quoteAvailable);
+      }
+
+      const resolvedServiceLabel = rawServiceLabel || SERVICE_LABELS[serviceKey] || 'Custom Package';
+      const resolvedSqftLabel = formatSqftLabel(rawSqftLabel, sqftKey);
+
+      const detailSelections = [];
+      function pushDetail(label, key, fallback){
+        let value = '';
+        if(key){
+          value = selectionLabelFromSources(key);
+        }
+        if(!value && fallback){
+          value = fallback;
+        }
+        if(value){
+          detailSelections.push(label + ': ' + value);
+        }
+      }
+      pushDetail('Service', null, resolvedServiceLabel || serviceKey);
+      pushDetail('Square Footage', null, resolvedSqftLabel || sqftKey);
+      pushDetail('Rooms', 'homeRooms');
+      pushDetail('Bathrooms', 'homeBathrooms');
+      pushDetail('Pets', 'homePets');
+      pushDetail('Basement', 'homeBasement');
+      pushDetail('Basement Rooms', 'homeBasementRooms');
+      pushDetail('Basement Bathrooms', 'homeBasementBathrooms');
+      pushDetail('Offices', 'officeOffices');
+      pushDetail('Office Bathrooms', 'officeBathrooms');
+
+      hiddenServiceKey.value = serviceKey;
+      hiddenServiceLabel.value = resolvedServiceLabel;
+      hiddenSqftLabel.value = resolvedSqftLabel;
+      const detailSummaryLines = detailSelections.slice();
+      const detailSummaryValue = detailSummaryLines.join(' | ');
+      const detailSummaryDisplay = detailSummaryLines.length
+        ? detailSummaryLines.join(' ‚Ä¢ ')
+        : (totalBase > 0 ? 'Base package from instant quote.' : '');
+      hiddenDetailSummary.value = detailSummaryValue || (totalBase > 0 ? 'Base package from instant quote.' : '');
+      hiddenBasePrice.value = quoteAvailable ? basePrice.toFixed(2) : '';
+      hiddenDetailPrice.value = quoteAvailable ? detailPrice.toFixed(2) : '';
+      hiddenPackage.value = resolvedServiceLabel;
+
+      if(recapDescription){
+        if(detailSummaryLines.length){
+          recapDescription.hidden = false;
+          recapDescription.innerHTML = detailSummaryLines
+            .map(line => `<span class="cart-detail-line">${escapeHtml(line)}</span>`)
+            .join('');
+        } else {
+          recapDescription.hidden = true;
+          recapDescription.innerHTML = '';
+        }
+      }
+
+      if(cartService){
+        cartService.textContent = quoteAvailable
+          ? (resolvedServiceLabel || 'Custom Package')
+          : 'Select a package on the quote page to see pricing here.';
+      }
+
+      if(cartStatus && !quoteAvailable){
+        cartStatus.classList.remove('error');
+        cartStatus.textContent = 'Select a package on the quote page to see pricing here.';
+      } else if(cartStatus && cartStatus.textContent === 'Select a package on the quote page to see pricing here.'){
+        cartStatus.textContent = '';
+      }
+
+      if(originField){
+        originField.value = serviceKey ? 'instant-quote' : 'book-page';
+      }
+
+      const sqftInput = form.querySelector('input[name="sqft"]');
+      if(sqftInput && sqftKey){
+        const avg = (() => {
+          if(sqftKey.includes('-')){
+            const parts = sqftKey.split('-').map(p => parseInt(p, 10));
+            if(parts.length === 2 && parts.every(n => !Number.isNaN(n))){
+              return Math.round((parts[0] + parts[1]) / 2);
+            }
+          }
+          return '';
+        })();
+        if(avg) sqftInput.value = avg;
+      }
+
+      const firstNameField = form.querySelector('input[name="first_name"]');
+      const lastNameField = form.querySelector('input[name="last_name"]');
+      const emailField = form.querySelector('input[name="email"]');
+      const quoteFirst = params.get('firstName') || '';
+      const quoteLast = params.get('lastName') || '';
+      const quoteFull = params.get('fullName') || '';
+      const quoteEmail = params.get('email');
+      if(firstNameField){
+        if(quoteFirst){
+          firstNameField.value = quoteFirst.trim();
+        } else if(quoteFull){
+          firstNameField.value = quoteFull.trim().split(/\s+/)[0] || '';
+        }
+      }
+      if(lastNameField){
+        if(quoteLast){
+          lastNameField.value = quoteLast.trim();
+        } else if(quoteFull){
+          const parts = quoteFull.trim().split(/\s+/);
+          if(parts.length > 1){ lastNameField.value = parts.slice(1).join(' '); }
+        }
+      }
+      if(emailField && quoteEmail) emailField.value = quoteEmail.trim();
+
+      function syncFullName(){
+        if(!hiddenFullName) return;
+        const first = firstNameField ? firstNameField.value.trim() : '';
+        const last = lastNameField ? lastNameField.value.trim() : '';
+        hiddenFullName.value = [first, last].filter(Boolean).join(' ');
+      }
+      syncFullName();
+      if(firstNameField) firstNameField.addEventListener('input', syncFullName);
+      if(lastNameField) lastNameField.addEventListener('input', syncFullName);
+
+      function formatCurrency(value){
+        if(!(value >= 0)){ return '‚Äî'; }
+        const amount = Math.max(0, Math.round(Number(value) || 0));
+        if(currencyFormatter){
+          return currencyFormatter.format(amount);
+        }
+        return `$${amount}`;
+      }
+
+      function updateAddonVisibility(){
+        let visibleGroups = 0;
+        addonGroups.forEach(group => {
+          const services = (group.dataset.serviceGroup || '').split(',');
+          const active = serviceKey && services.includes(serviceKey);
+          group.classList.toggle('active', active);
+          if(active) visibleGroups += 1;
+        });
+        if(addonEmptyMessage){ addonEmptyMessage.hidden = visibleGroups !== 0; }
+      }
+      updateAddonVisibility();
+
+      function dispatchNavCartUpdate(justAdded){
+        if(typeof window.updateNavCartPopover !== 'function') return;
+        if(!latestCartState){
+          window.updateNavCartPopover(null);
+          return;
+        }
+        const snapshot = Object.assign({}, latestCartState);
+        if(justAdded){ snapshot.justAdded = true; }
+        window.updateNavCartPopover(snapshot);
+      }
+
+      function triggerCartFlight(){
+        if(!cartSummaryEl || !navCartButton || !quoteAvailable) return;
+        const start = cartSummaryEl.getBoundingClientRect();
+        const end = navCartButton.getBoundingClientRect();
+        if(!start.width || !end.width) return;
+
+        const flight = document.createElement('div');
+        flight.className = 'cart-flight';
+        const img = document.createElement('img');
+        const preview = cartSummaryEl.querySelector('img');
+        img.src = (preview && preview.src) ? preview.src : (CART_IMAGE_PATH || CART_IMAGE_DATA_URI || DEFAULT_CART_IMAGE);
+        img.alt = '';
+        img.setAttribute('aria-hidden', 'true');
+        flight.appendChild(img);
+
+        const size = Math.max(Math.min(start.width, 140), 76);
+        flight.style.width = `${size}px`;
+        flight.style.height = `${size}px`;
+        flight.style.left = `${start.left + (start.width / 2) - (size / 2)}px`;
+        flight.style.top = `${start.top + (start.height / 2) - (size / 2)}px`;
+
+        document.body.appendChild(flight);
+
+        const deltaX = end.left + end.width / 2 - (start.left + start.width / 2);
+        const deltaY = end.top + end.height / 2 - (start.top + start.height / 2);
+
+        flight.style.opacity = '1';
+        const animation = flight.animate([
+          { transform: 'translate3d(0,0,0) scale(1)', opacity: 1 },
+          { transform: `translate3d(${deltaX}px, ${deltaY}px, 0) scale(0.35)`, opacity: 0 }
+        ], {
+          duration: 720,
+          easing: 'cubic-bezier(0.2, 0.75, 0.12, 1)'
+        });
+
+        animation.onfinish = () => flight.remove();
+        animation.oncancel = () => flight.remove();
+
+        cartSummaryEl.classList.add('cart-summary-flight');
+        window.setTimeout(() => {
+          cartSummaryEl.classList.remove('cart-summary-flight');
+        }, 640);
+      }
+
+      function ensureCartAdded(options){
+        if(cartAdded || !quoteAvailable) return;
+        const freqInput = selectedFrequency();
+        if(!freqInput) return;
+        cartAdded = true;
+        refreshCartButton();
+        if(cartStatus){
+          cartStatus.classList.remove('error');
+          cartStatus.textContent = 'Package added to your cart. Continue through the steps to finalize.';
+        }
+        if(options && options.animate){
+          triggerCartFlight();
+        }
+        updateSummary();
+        dispatchNavCartUpdate(true);
+      }
+
+      const extrasState = [];
+      function computeExtras(){
+        extrasState.length = 0;
+        addonPills.forEach(pill => {
+          const parent = pill.closest('.addon-group');
+          if(!parent || !parent.classList.contains('active')) return;
+          if(!pill.classList.contains('active')) return;
+          const qtyInput = pill.querySelector('.addon-qty');
+          const qty = qtyInput ? Math.max(Number(qtyInput.value) || 1, Number(qtyInput.min) || 1) : 1;
+          const price = Number(pill.dataset.price || 0);
+          const name = pill.querySelector('.addon-name')?.textContent.trim() || pill.dataset.addon || 'Addon';
+          extrasState.push({ name, qty, price });
+        });
+        return extrasState;
+      }
+
+      function clearExtras(){
+        addonPills.forEach(pill => {
+          pill.classList.remove('active');
+          pill.setAttribute('aria-pressed', 'false');
+          const qtyInput = pill.querySelector('.addon-qty');
+          if(qtyInput){
+            qtyInput.disabled = true;
+            if(qtyInput.min){
+              qtyInput.value = qtyInput.min;
+            }
+          }
+        });
+        updateSummary();
+      }
+
+      function buildExtrasLabel(){
+        if(!extrasState.length) return '';
+        return extrasState.map(item => `${item.name} √ó${item.qty}`).join(', ');
+      }
+
+      function getSelectedPayment(){
+        const selected = paymentRadios.find(radio => radio.checked);
+        return selected ? selected.value : null;
+      }
+
+      function clearPayPalHidden(){
+        if(hiddenPayPalOrder) hiddenPayPalOrder.value = '';
+        if(hiddenPayPalPayer) hiddenPayPalPayer.value = '';
+        if(hiddenPayPalCapture) hiddenPayPalCapture.value = '';
+      }
+
+      function setPayPalStatus(message, tone, context){
+        const keys = context ? [context] : Object.keys(PAYPAL_CONTEXTS);
+        keys.forEach(key => {
+          const entry = PAYPAL_CONTEXTS[key];
+          if(!entry || !entry.status) return;
+          entry.status.textContent = message || '';
+          entry.status.classList.toggle('error', tone === 'error');
+          entry.status.hidden = !message;
+        });
+      }
+
+      function syncSubmitDisabled(){
+        if(!submitBtn) return;
+        const method = getSelectedPayment();
+        submitBtn.disabled = method === 'paypal' && !paypalApproved;
+      }
+
+      function togglePayPalUi(show){
+        if(paypalUi){
+          paypalUi.hidden = !show;
+        }
+        if(!show){
+          setPayPalStatus('', 'info');
+        }
+      }
+
+      function resetPayPalApproval(message, tone){
+        paypalApproved = false;
+        paypalApprovedAmount = 0;
+        clearPayPalHidden();
+        if(message && getSelectedPayment() === 'paypal'){
+          setPayPalStatus(message, tone || 'info');
+        } else if(!message){
+          setPayPalStatus('', 'info');
+        }
+        syncSubmitDisabled();
+      }
+
+      function resolvePayPalClientId(){
+        if(document.body && document.body.dataset && document.body.dataset.paypalClientId){
+          return document.body.dataset.paypalClientId.trim();
+        }
+        if(typeof window !== 'undefined' && window.PAYPAL_CLIENT_ID){
+          return String(window.PAYPAL_CLIENT_ID).trim();
+        }
+        return '';
+      }
+
+      function loadPayPalSdk(){
+        if(window.paypal && typeof window.paypal.Buttons === 'function'){
+          return Promise.resolve(window.paypal);
+        }
+        if(paypalScriptPromise){
+          return paypalScriptPromise;
+        }
+
+        const clientId = resolvePayPalClientId();
+        if(!clientId){
+          const err = new Error('PayPal client ID is not configured.');
+          paypalScriptPromise = Promise.reject(err);
+          paypalScriptPromise.catch(() => { paypalScriptPromise = null; });
+          return paypalScriptPromise;
+        }
+
+        paypalScriptPromise = new Promise((resolve, reject) => {
+          const script = document.createElement('script');
+          const params = new URLSearchParams({
+            'client-id': clientId,
+            currency: PAYPAL_CURRENCY,
+            intent: 'capture'
+          });
+          script.src = `https://www.paypal.com/sdk/js?${params.toString()}`;
+          script.async = true;
+          script.onload = () => {
+            if(window.paypal && typeof window.paypal.Buttons === 'function'){
+              resolve(window.paypal);
+            } else {
+              reject(new Error('PayPal SDK loaded but Buttons API is unavailable.'));
+            }
+          };
+          script.onerror = () => {
+            reject(new Error('PayPal SDK failed to load.'));
+          };
+          document.head.appendChild(script);
+        }).catch(err => {
+          paypalScriptPromise = null;
+          throw err;
+        });
+
+        return paypalScriptPromise;
+      }
+
+      function destroyPayPalButtons(context){
+        const entry = PAYPAL_CONTEXTS[context];
+        if(!entry || !entry.container) return;
+        if(paypalButtonsInstances[context] && typeof paypalButtonsInstances[context].close === 'function'){
+          try { paypalButtonsInstances[context].close(); } catch(_) {}
+        }
+        delete paypalButtonsInstances[context];
+        entry.container.innerHTML = '';
+      }
+
+      function ensurePayPalButtons(context = 'main'){
+        const entry = PAYPAL_CONTEXTS[context];
+        if(!entry || !entry.container) return;
+        if(paypalButtonsInstances[context]) return;
+
+        setPayPalStatus('Loading PayPal‚Ä¶', 'info', context);
+        loadPayPalSdk().then(paypal => {
+          if(paypalButtonsInstances[context]){
+            return paypalButtonsInstances[context];
+          }
+
+          entry.container.innerHTML = '';
+          const buttons = paypal.Buttons({
+            style: {
+              layout: 'vertical',
+              color: 'gold',
+              label: 'pay',
+              shape: 'rect'
+            },
+            onClick(data, actions){
+              const deposit = Number(hiddenDepositPrice.value || 0);
+              if(!(deposit > 0)){
+                setPayPalStatus('Finish selecting your services so we can calculate the deposit before paying with PayPal.', 'error');
+                return actions.reject();
+              }
+              paypalApproved = false;
+              paypalApprovedAmount = 0;
+              clearPayPalHidden();
+              syncSubmitDisabled();
+              setPayPalStatus('Redirecting to PayPal‚Ä¶');
+              return actions.resolve();
+            },
+            createOrder(data, actions){
+              const deposit = Number(hiddenDepositPrice.value || 0);
+              if(!(deposit > 0)){
+                setPayPalStatus('Your deposit total is missing. Adjust your booking details before checking out with PayPal.', 'error');
+                return actions.reject();
+              }
+              const amount = (Math.round(deposit * 100) / 100).toFixed(2);
+              return actions.order.create({
+                purchase_units: [{
+                  amount: {
+                    currency_code: PAYPAL_CURRENCY,
+                    value: amount
+                  },
+                  description: 'Dufferin Deep Clean 50% deposit'
+                }],
+                application_context: {
+                  shipping_preference: 'NO_SHIPPING'
+                }
+              });
+            },
+            onApprove(data, actions){
+              setPayPalStatus('Processing your PayPal payment‚Ä¶');
+              return actions.order.capture().then(details => {
+                paypalApproved = true;
+                paypalApprovedAmount = Math.round(Number(hiddenDepositPrice.value || 0) * 100) / 100;
+                if(hiddenPayPalOrder) hiddenPayPalOrder.value = data.orderID || details.id || '';
+                if(hiddenPayPalPayer) hiddenPayPalPayer.value = details?.payer?.payer_id || '';
+                const capture = details?.purchase_units?.[0]?.payments?.captures?.[0];
+                if(hiddenPayPalCapture) hiddenPayPalCapture.value = capture?.id || '';
+                const payerName = details?.payer?.name?.given_name || 'PayPal customer';
+                setPayPalStatus(`Deposit received from ${payerName}. You can now submit your booking.`);
+                syncSubmitDisabled();
+                buildReview();
+                dispatchNavCartUpdate(false);
+              }).catch(err => {
+                console.error('PayPal capture error', err);
+                resetPayPalApproval();
+                setPayPalStatus('PayPal could not capture the payment. Please try again.', 'error');
+                throw err;
+              });
+            },
+            onCancel(){
+              resetPayPalApproval('PayPal checkout was cancelled. You can try again or contact us for assistance.', 'error');
+            },
+            onError(err){
+              console.error('PayPal error', err);
+              resetPayPalApproval('PayPal reported an error. Please try again or contact us for assistance.', 'error');
+            }
+          });
+
+          paypalButtonsInstances[context] = buttons;
+          return buttons.render(entry.container).catch(err => {
+            console.error('PayPal render error', err);
+            destroyPayPalButtons(context);
+            resetPayPalApproval('PayPal could not initialize. Refresh the page or contact us for assistance.', 'error');
+            throw err;
+          });
+        }).catch(err => {
+          console.error('PayPal load error', err);
+          destroyPayPalButtons(context);
+          const message = 'PayPal checkout is currently unavailable. Please contact us to complete your deposit.';
+          setPayPalStatus(message, 'error', context);
+        });
+      }
+
+      document.addEventListener('nav-cart:opened', () => {
+        ensurePayPalButtons('nav');
+      });
+
+      function applyPaymentSelection(){
+        const method = getSelectedPayment();
+        if(method === 'paypal'){
+          togglePayPalUi(true);
+          ensurePayPalButtons('main');
+          ensurePayPalButtons('nav');
+          if(paypalApproved){
+            setPayPalStatus('PayPal deposit approved. You can submit your booking.');
+          } else {
+            setPayPalStatus('Complete your PayPal deposit to enable submission.');
+          }
+        } else {
+          togglePayPalUi(false);
+          resetPayPalApproval('');
+          setPayPalStatus('', 'info');
+        }
+        syncSubmitDisabled();
+      }
+
+      function selectedFrequency(){
+        return frequencyInputs.find(input => input.checked) || null;
+      }
+
+      function refreshCartButton(){
+        if(addToCartBtn){
+          const label = addToCartBtn.querySelector('.cart-btn-text');
+          const labelText = cartAdded ? 'Added to Cart' : 'Add to Cart';
+          if(label){
+            label.textContent = labelText;
+          } else {
+            addToCartBtn.textContent = labelText;
+          }
+          addToCartBtn.classList.toggle('is-added', cartAdded);
+          addToCartBtn.setAttribute('aria-disabled', addToCartBtn.disabled ? 'true' : 'false');
+        }
+        if(hiddenCartStatus){
+          hiddenCartStatus.value = cartAdded ? 'added' : 'pending';
+        }
+        if(cartSummaryEl){
+          cartSummaryEl.classList.toggle('is-added', cartAdded);
+        }
+      }
+
+      function applyCartVisibility(stepIndex){
+        if(!cartSummaryEl || !formColumnsEl) return;
+        const hide = stepIndex > 1;
+        cartSummaryEl.hidden = hide;
+        cartSummaryEl.setAttribute('aria-hidden', hide ? 'true' : 'false');
+        formColumnsEl.classList.toggle('cart-summary-hidden', hide);
+      }
+
+      function updateSummary(){
+        applyCartVisibility(current);
+        if(!quoteAvailable){
+          cartAdded = false;
+          if(cartStatus){
+            cartStatus.classList.remove('error');
+            cartStatus.textContent = 'Select a package on the quote page to see pricing here.';
+          }
+          if(recapBase) recapBase.textContent = '‚Äî';
+          if(recapDetailRow){
+            recapDetailRow.hidden = true;
+          }
+          if(recapExtrasRow){
+            recapExtrasRow.hidden = true;
+          }
+          if(recapDiscountRow){
+            recapDiscountRow.hidden = true;
+          }
+          if(recapTotal){
+            recapTotal.textContent = '‚Äî';
+          }
+          if(depositText){ depositText.textContent = '‚Äî'; }
+          if(balanceText){ balanceText.textContent = '‚Äî'; }
+          if(addToCartBtn){
+            addToCartBtn.disabled = true;
+            addToCartBtn.setAttribute('aria-disabled', 'true');
+          }
+          refreshCartButton();
+          latestCartState = null;
+          dispatchNavCartUpdate(false);
+          return;
+        }
+        const extras = computeExtras();
+        const extrasTotal = extras.reduce((sum, item) => sum + item.price * item.qty, 0);
+        const freqInput = selectedFrequency();
+        const discountRate = freqInput ? Number(freqInput.dataset.discount || 0) : 0;
+        const subtotal = totalBase + extrasTotal;
+        const discount = subtotal * discountRate;
+        const finalTotal = subtotal - discount;
+        const depositDue = finalTotal > 0 ? finalTotal * DEPOSIT_RATE : 0;
+        const balanceDue = finalTotal > 0 ? Math.max(finalTotal - depositDue, 0) : 0;
+
+        const baseLabel = hiddenServiceLabel.value || resolvedServiceLabel || serviceKey || 'Custom Package';
+        const freqLabel = freqInput ? (FREQUENCY_LABELS[freqInput.value] || freqInput.value) : '';
+
+        if(cartService){
+          cartService.textContent = freqLabel ? `${baseLabel} ‚Ä¢ ${freqLabel}` : baseLabel;
+        }
+
+        if(depositText){ depositText.textContent = (quoteAvailable && depositDue > 0) ? formatCurrency(depositDue) : '‚Äî'; }
+        if(balanceText){ balanceText.textContent = (quoteAvailable && balanceDue > 0) ? formatCurrency(balanceDue) : '‚Äî'; }
+
+        if(recapBase){ recapBase.textContent = quoteAvailable ? formatCurrency(basePrice) : '‚Äî'; }
+        if(recapDetailRow && recapDetail){
+          if(detailPrice > 0){
+            recapDetailRow.hidden = false;
+            recapDetail.textContent = `+${formatCurrency(detailPrice)}`;
+          } else {
+            recapDetailRow.hidden = true;
+            recapDetail.textContent = '‚Äî';
+          }
+        }
+        if(recapExtrasRow && recapExtras){
+          if(extrasTotal > 0){
+            recapExtrasRow.hidden = false;
+            recapExtras.textContent = `+${formatCurrency(extrasTotal)}`;
+          } else {
+            recapExtrasRow.hidden = true;
+            recapExtras.textContent = '‚Äî';
+          }
+        }
+        if(recapDiscountRow && recapDiscount){
+          if(discount > 0){
+            recapDiscountRow.hidden = false;
+            recapDiscount.textContent = `-${formatCurrency(discount)}`;
+          } else {
+            recapDiscountRow.hidden = true;
+            recapDiscount.textContent = '‚Äî';
+          }
+        }
+        if(recapTotal){
+          recapTotal.textContent = quoteAvailable ? formatCurrency(finalTotal) : '‚Äî';
+        }
+
+        if(hiddenAddonsPrice) hiddenAddonsPrice.value = extrasTotal.toFixed(2);
+        if(hiddenDiscountPrice) hiddenDiscountPrice.value = discount.toFixed(2);
+        if(hiddenDepositPrice) hiddenDepositPrice.value = depositDue.toFixed(2);
+        if(hiddenBalancePrice) hiddenBalancePrice.value = balanceDue.toFixed(2);
+        if(hiddenTotalPrice) hiddenTotalPrice.value = finalTotal.toFixed(2);
+        const extrasLabel = buildExtrasLabel();
+        if(hiddenSelectedAddons) hiddenSelectedAddons.value = extrasLabel;
+
+        const signature = [basePrice, detailPrice, extrasTotal, discount, finalTotal].map(value => Math.round(value * 100) / 100).join('|');
+        if(signature !== lastCartSignature){
+          const wasAdded = cartAdded;
+          lastCartSignature = signature;
+          if(wasAdded){
+            cartAdded = false;
+            refreshCartButton();
+            if(cartStatus){
+              cartStatus.classList.remove('error');
+              cartStatus.textContent = "Totals updated. Add to cart again when you're ready.";
+            }
+          } else if(cartStatus && cartStatus.textContent && cartStatus.textContent.includes('Totals updated')){
+            cartStatus.textContent = '';
+          }
+        }
+
+        const normalizedDeposit = Math.round(depositDue * 100) / 100;
+        if(paypalApproved && Math.abs(normalizedDeposit - paypalApprovedAmount) > 0.01){
+          paypalApproved = false;
+          paypalApprovedAmount = 0;
+          clearPayPalHidden();
+          if(getSelectedPayment() === 'paypal'){
+            setPayPalStatus('Your deposit total changed. Please approve the PayPal payment again.');
+          }
+        }
+
+        if(addToCartBtn){
+          const hasFrequency = !!freqInput;
+          const canAdd = quoteAvailable && current >= 1 && hasFrequency;
+          addToCartBtn.disabled = cartAdded ? true : !canAdd;
+          addToCartBtn.setAttribute('aria-disabled', addToCartBtn.disabled ? 'true' : 'false');
+          if(!quoteAvailable){
+            if(cartStatus && cartStatus.textContent === ''){
+              cartStatus.textContent = 'Select a package on the quote page to see pricing here.';
+            }
+          } else if(!canAdd){
+            if(!cartAdded && cartStatus){
+              if(current >= 1){
+                cartStatus.classList.remove('error');
+                cartStatus.textContent = 'Select a visit frequency to add this package to your cart.';
+              } else if(cartStatus.textContent === 'Select a visit frequency to add this package to your cart.'){
+                cartStatus.textContent = '';
+              }
+            }
+          } else if(!cartAdded && cartStatus && cartStatus.textContent === 'Select a visit frequency to add this package to your cart.'){
+            cartStatus.textContent = '';
+          }
+        }
+
+        refreshCartButton();
+        syncSubmitDisabled();
+
+        latestCartState = {
+          cartAdded,
+          quantity: 1,
+          serviceLabel: baseLabel,
+          frequencyLabel: freqLabel,
+          basePrice,
+          detailPrice,
+          extrasTotal,
+          extrasLabel,
+          discount,
+          total: finalTotal,
+          deposit: depositDue,
+          balance: balanceDue,
+          checkoutUrl: 'book.html#cartSummary',
+          status: cartStatus && cartStatus.textContent ? cartStatus.textContent : ''
+        };
+        dispatchNavCartUpdate(false);
+      }
+
+      function adjustAddonQuantity(input, delta){
+        if(!input || !Number.isFinite(delta)) return;
+        const step = Number(input.step || 1) || 1;
+        const min = input.min !== '' ? Number(input.min) : 1;
+        const max = input.max !== '' ? Number(input.max) : null;
+        const current = input.value === '' ? min : Number(input.value);
+        let next = Number.isFinite(current) ? current + delta * step : min;
+        if(next < min) next = min;
+        if(max !== null && Number.isFinite(max)) next = Math.min(next, max);
+        input.value = String(next);
+        input.dispatchEvent(new Event('input', { bubbles: true }));
+      }
+
+      addonPills.forEach(pill => {
+        const qtyInput = pill.querySelector('.addon-qty');
+        if(qtyInput){
+          qtyInput.disabled = true;
+        }
+
+        pill.addEventListener('click', (event) => {
+          if(event.target === qtyInput || event.target.closest('.addon-stepper')) return;
+          const parent = pill.closest('.addon-group');
+          if(!parent || !parent.classList.contains('active')) return;
+
+          autoAddAfterSkip = false;
+          pill.classList.toggle('active');
+          const active = pill.classList.contains('active');
+          pill.setAttribute('aria-pressed', active ? 'true' : 'false');
+          if(qtyInput){
+            qtyInput.disabled = !active;
+            if(active && (!qtyInput.value || Number(qtyInput.value) < Number(qtyInput.min || 1))){
+              qtyInput.value = qtyInput.min || 1;
+            }
+          }
+          updateSummary();
+        });
+
+        pill.addEventListener('keydown', evt => {
+          if(evt.key === 'Enter' || evt.key === ' '){
+            evt.preventDefault();
+            pill.click();
+          }
+        });
+
+        pill.setAttribute('tabindex', '0');
+        pill.setAttribute('role', 'button');
+        pill.setAttribute('aria-pressed', 'false');
+
+        if(qtyInput){
+          qtyInput.addEventListener('input', () => {
+            if(!pill.classList.contains('active')) return;
+            if(qtyInput.value === '' || Number(qtyInput.value) < Number(qtyInput.min || 1)){
+              qtyInput.value = qtyInput.min || 1;
+            }
+            updateSummary();
+          });
+
+          const stepperButtons = pill.querySelectorAll('.stepper-button');
+          stepperButtons.forEach(button => {
+            button.addEventListener('click', (event) => {
+              event.preventDefault();
+              event.stopPropagation();
+              autoAddAfterSkip = false;
+              const delta = Number(button.dataset.qtyStep || button.dataset.step || 0);
+              if(!delta) return;
+              const parent = pill.closest('.addon-group');
+              if(parent && !parent.classList.contains('active')) return;
+              if(!pill.classList.contains('active')){
+                pill.classList.add('active');
+                pill.setAttribute('aria-pressed', 'true');
+                qtyInput.disabled = false;
+                if(!qtyInput.value || Number(qtyInput.value) < Number(qtyInput.min || 1)){
+                  qtyInput.value = qtyInput.min || 1;
+                }
+              }
+              adjustAddonQuantity(qtyInput, delta);
+            });
+          });
+        }
+      });
+
+      frequencyInputs.forEach(input => {
+        input.addEventListener('change', () => {
+          if(cartStatus){
+            cartStatus.classList.remove('error');
+            if(cartStatus.textContent === 'Select a visit frequency to add this package to your cart.' ||
+               cartStatus.textContent === 'Please choose how often we should visit before moving on.'){
+              cartStatus.textContent = '';
+            }
+          }
+          updateSummary();
+          if(autoAddAfterSkip){
+            ensureCartAdded({ animate: true });
+          }
+        });
+      });
+
+      paymentRadios.forEach(radio => {
+        radio.addEventListener('change', applyPaymentSelection);
+      });
+
+      if(addToCartBtn){
+        addToCartBtn.addEventListener('click', () => {
+          if(addToCartBtn.disabled) return;
+          cartAdded = true;
+          refreshCartButton();
+          if(cartStatus){
+            cartStatus.classList.remove('error');
+            cartStatus.textContent = 'Package added to your cart. Continue through the steps to finalize.';
+          }
+          triggerCartFlight();
+          updateSummary();
+          dispatchNavCartUpdate(true);
+        });
+      }
+
+      function showStep(i){
+        steps.forEach((step, idx) => { step.hidden = idx !== i; });
+        stepper.forEach((item, idx) => {
+          const isActive = idx === i;
+          const isDone = idx < i;
+          const isClickable = idx <= i;
+          item.classList.toggle('active', isActive);
+          item.classList.toggle('done', isDone);
+          item.classList.toggle('clickable', isClickable);
+          item.tabIndex = isClickable ? 0 : -1;
+          item.setAttribute('aria-current', isActive ? 'step' : 'false');
+          item.setAttribute('aria-disabled', isClickable ? 'false' : 'true');
+        });
+        current = i;
+        applyCartVisibility(i);
+        updateSummary();
+        window.scrollTo({ top: 0, behavior: 'smooth' });
+        if(i === steps.length - 1){
+          buildReview();
+          applyPaymentSelection();
+        }
+      }
+
+      document.addEventListener('click', (event) => {
+        if(event.target.matches('.skip')){
+          clearExtras();
+          autoAddAfterSkip = true;
+          const nextIndex = Math.min(current + 1, steps.length - 1);
+          showStep(nextIndex);
+          if(frequencyInputs.length){
+            frequencyInputs[0].focus();
+          }
+          return;
+        }
+        if(event.target.matches('.next')){
+          if(current === 1){
+            if(!quoteAvailable){
+              if(cartStatus){
+                cartStatus.classList.add('error');
+                cartStatus.textContent = 'Select a package on the quote page to see pricing here.';
+              }
+              return;
+            }
+            const freqCheck = selectedFrequency();
+            if(!freqCheck){
+              if(cartStatus){
+                cartStatus.classList.add('error');
+                cartStatus.textContent = 'Please choose how often we should visit before moving on.';
+              }
+              if(frequencyInputs.length){
+                frequencyInputs[0].focus();
+              }
+              return;
+            }
+          }
+          const visible = steps[current];
+          const required = Array.from(visible.querySelectorAll('[required]'));
+          for(const field of required){
+            if(!field.value){
+              field.focus();
+              if(field.reportValidity){ field.reportValidity(); }
+              return;
+            }
+          }
+          const prevIndex = current;
+          const nextIndex = Math.min(current + 1, steps.length - 1);
+          showStep(nextIndex);
+        }
+        if(event.target.matches('.back')){
+          showStep(Math.max(current - 1, 0));
+        }
+      });
+
+      function buildReview(){
+        if(!reviewList) return;
+        syncFullName();
+        const fd = new FormData(form);
+        const fullName = (() => {
+          const fields = [fd.get('first_name'), fd.get('last_name')].filter(Boolean).map(v => v.trim());
+          if(hiddenFullName && hiddenFullName.value) return hiddenFullName.value;
+          if(fields.length) return fields.join(' ');
+          return '';
+        })();
+        if(hiddenFullName && !hiddenFullName.value){
+          hiddenFullName.value = fullName;
+        }
+
+        const rows = [
+          ['Service', hiddenServiceLabel.value || '‚Äî'],
+          ['Square Footage', hiddenSqftLabel.value || fd.get('sqft') || '‚Äî'],
+          ['Details', hiddenDetailSummary.value || '‚Äî'],
+          ['Frequency', FREQUENCY_LABELS[fd.get('frequency')] || '‚Äî'],
+          ['Add-ons', hiddenSelectedAddons.value || 'None'],
+          ['Base Package', hiddenBasePrice.value ? `$${Math.round(Number(hiddenBasePrice.value))}` : '‚Äî'],
+          ['Service Details', hiddenDetailPrice.value ? `$${Math.round(Number(hiddenDetailPrice.value))}` : '‚Äî'],
+          ['Add-on Total', hiddenAddonsPrice.value ? `$${Math.round(Number(hiddenAddonsPrice.value))}` : '‚Äî'],
+          ['Frequency Savings', hiddenDiscountPrice.value && Number(hiddenDiscountPrice.value) ? `-$${Math.round(Number(hiddenDiscountPrice.value))}` : '‚Äî'],
+          ['Deposit Due Today', hiddenDepositPrice.value && Number(hiddenDepositPrice.value) ? `$${Math.round(Number(hiddenDepositPrice.value))}` : '‚Äî'],
+          ['Balance at Service', hiddenBalancePrice.value && Number(hiddenBalancePrice.value) ? `$${Math.round(Number(hiddenBalancePrice.value))}` : '‚Äî'],
+          ['Estimated Visit Total', hiddenTotalPrice.value && Number(hiddenTotalPrice.value) ? `$${Math.round(Number(hiddenTotalPrice.value))}` : '‚Äî'],
+          ['PayPal Reference', hiddenPayPalCapture.value || hiddenPayPalOrder.value || '‚Äî'],
+          ['Business', fd.get('business') || '‚Äî'],
+          ['Address', [fd.get('address'), fd.get('city'), fd.get('postal')].filter(Boolean).join(', ') || '‚Äî'],
+          ['Preferred Date', fd.get('date') || '‚Äî'],
+          ['Preferred Time', fd.get('time') || '‚Äî'],
+          ['Full Name', fullName || '‚Äî'],
+          ['Email', fd.get('email') || '‚Äî'],
+          ['Phone', fd.get('phone') || '‚Äî'],
+          ['Notes', fd.get('notes') || '‚Äî'],
+          ['Cart Status', hiddenCartStatus && hiddenCartStatus.value === 'added' ? 'Added to cart' : 'Not added yet']
+        ];
+
+        reviewList.innerHTML = rows.map(([label, value]) => `<dt>${label}</dt><dd>${String(value)}</dd>`).join('');
+      }
+
+      form.addEventListener('submit', async (event) => {
+        event.preventDefault();
+
+        const method = getSelectedPayment();
+        if(method === 'paypal' && !paypalApproved){
+          setPayPalStatus('Please complete your PayPal deposit before submitting your booking.', 'error');
+          return;
+        }
+
+        if(hiddenCartStatus && hiddenCartStatus.value !== 'added'){
+          if(cartStatus){
+            cartStatus.classList.add('error');
+            cartStatus.textContent = 'Please add the package to your cart before confirming.';
+          }
+          if(addToCartBtn) addToCartBtn.focus();
+          return;
+        }
+
+        const allButtons = form.querySelectorAll('button');
+        allButtons.forEach(btn => btn.disabled = true);
+        if(submitBtn) submitBtn.textContent = 'Sending‚Ä¶';
+
+        syncFullName();
+        const fd = new FormData(form);
+        if(!fd.get('_subject')){
+          fd.append('_subject', 'New Booking Request ‚Äî Dufferin Deep Clean');
+        }
+
+        const fullName = hiddenFullName ? hiddenFullName.value : [fd.get('first_name'), fd.get('last_name')].filter(Boolean).join(' ');
+        if(fullName){ fd.set('name', fullName); }
+        const freqMapShort = {
+          weekly: 'Weekly (25%)',
+          biweekly: 'Bi-Weekly (20%)',
+          triweekly: 'Tri-Weekly (15%)',
+          monthly: 'Monthly (10%)',
+          biannual: 'Biannual (5%)',
+          onetime: 'One-time'
+        };
+        const summaryLines = [
+          `Service: ${hiddenServiceLabel.value || serviceKey || '‚Äî'}`,
+          `Square Footage: ${hiddenSqftLabel.value || fd.get('sqft') || '‚Äî'}`,
+          `Details: ${hiddenDetailSummary.value || '‚Äî'}`,
+          `Frequency: ${freqMapShort[fd.get('frequency')] || '‚Äî'}`,
+          `Cart Status: ${hiddenCartStatus && hiddenCartStatus.value === 'added' ? 'Added to cart' : 'Not added yet'}`,
+          `Base Package: ${hiddenBasePrice.value ? `$${Math.round(Number(hiddenBasePrice.value))}` : '‚Äî'}`,
+          `Service Details: ${hiddenDetailPrice.value ? `$${Math.round(Number(hiddenDetailPrice.value))}` : '‚Äî'}`,
+          `Add-ons: ${hiddenSelectedAddons.value || 'None'}`,
+          `Add-on Total: ${hiddenAddonsPrice.value ? `$${Math.round(Number(hiddenAddonsPrice.value))}` : '‚Äî'}`,
+          `Frequency Savings: ${hiddenDiscountPrice.value && Number(hiddenDiscountPrice.value) ? `-$${Math.round(Number(hiddenDiscountPrice.value))}` : '‚Äî'}`,
+          `Deposit Due Today: ${hiddenDepositPrice.value && Number(hiddenDepositPrice.value) ? `$${Math.round(Number(hiddenDepositPrice.value))}` : '‚Äî'}`,
+          `Balance at Service: ${hiddenBalancePrice.value && Number(hiddenBalancePrice.value) ? `$${Math.round(Number(hiddenBalancePrice.value))}` : '‚Äî'}`,
+          `Estimated Visit Total: ${hiddenTotalPrice.value && Number(hiddenTotalPrice.value) ? `$${Math.round(Number(hiddenTotalPrice.value))}` : '‚Äî'}`,
+          `Full Name: ${fullName || '‚Äî'}`,
+          `Email: ${fd.get('email') || '‚Äî'}`,
+          `Phone: ${fd.get('phone') || '‚Äî'}`
+        ];
+
+        if(hiddenPayPalCapture.value || hiddenPayPalOrder.value){
+          summaryLines.push(`PayPal Reference: ${hiddenPayPalCapture.value || hiddenPayPalOrder.value}`);
+        }
+
+        const pricingSummary = summaryLines.join('\n');
+
+        fd.append('pricing_summary', pricingSummary);
+
+        try {
+          const res = await fetch(form.action, {
+            method: 'POST',
+            body: fd,
+            headers: { Accept: 'application/json' }
+          });
+
+          if(res.ok){
+            form.hidden = true;
+            if(layoutEl) layoutEl.hidden = true;
+            if(successEl) successEl.hidden = false;
+          } else {
+            let message = 'There was a problem sending your booking request. Please try again.';
+            try {
+              const data = await res.json();
+              if(data && data.errors && data.errors.length){
+                message = data.errors.map(err => err.message).join('\n');
+              }
+            } catch(_){}
+            alert(message);
+          }
+        } catch(err){
+          alert('Network error. Please check your connection and try again.');
+        } finally {
+          allButtons.forEach(btn => btn.disabled = false);
+          if(submitBtn) submitBtn.textContent = 'Submit';
+        }
+      });
+
+      updateSummary();
+      applyPaymentSelection();
+      showStep(0);
+    })();
+  </script>
+</body>
+</html>
