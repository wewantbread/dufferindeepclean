<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>DufferinDeepClean</title>

  <!-- Favicons / PWA -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192x192.png">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="DeepClean" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- Fonts + CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Great+Vibes&family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />

  <!-- Page-specific tweaks (safe to keep inline) -->
  <style>
    /* keep sections above animated bg from style.css */
    .navbar, .announcement, .split-screen, .services-page, .about-section, main, section, footer { position:relative; z-index:2; }

    /* Transparent header over infinite bg */
    .navbar{
      background: rgba(0,0,0,0.25) !important;
      backdrop-filter: blur(6px);
      border-bottom: 1px solid rgba(255,255,255,0.07);
    }

    /* Logo: match ‚Äúabout us‚Äù font + left‚Üíright reveal + bigger */
    @keyframes logoUnveil{0%{clip-path:inset(0 100% 0 0);opacity:0}40%{opacity:1}100%{clip-path:inset(0 0 0 0);opacity:1}}
    @keyframes logoSweep{0%{opacity:1;transform:translateX(-105%)}60%{opacity:.75}100%{opacity:0;transform:translateX(120%)}}
    .logo .logo-text{
      font-family: 'Great Vibes', cursive !important;
      font-size: 2.8rem !important;
      letter-spacing: .5px;
      color:#fff !important;
      position:relative;
      display:inline-block;
      clip-path: inset(0 100% 0 0);
      opacity:0; animation: logoUnveil 1.1s ease forwards .25s;
    }
    .logo .logo-text::after{
      content:""; position:absolute; inset:0;
      background: linear-gradient(90deg, rgba(0,212,255,.85), rgba(255,255,255,.95));
      mix-blend-mode: screen; opacity:0; pointer-events:none;
      animation: logoSweep 1.1s ease forwards .25s;
    }

    /* Nav links in same script font */
    .nav-links a{
      font-family:'Great Vibes', cursive !important;
      font-size:1.6rem !important;
      letter-spacing:.02em;
      color:#f6fbff;
    }

    /* Hero image flush to right edge */
    .image-side img{
      transform:none !important;
      object-position: right center !important;
    }

    /* ===== Rotator card (with slide animations) ===== */
    .rotator-card{
      margin-top: 1.25rem;
      padding: 1.4rem 1.6rem;
      max-width: 560px;
      border-radius: 20px;
      border:1px solid rgba(0,212,255,0.25);
      background: rgba(0,0,0,0.55);
      box-shadow: 0 20px 60px rgba(0,0,0,0.45), 0 0 22px rgba(0,212,255,0.12);
      backdrop-filter: blur(8px);
      overflow: hidden;
      position: relative;
    }
    .rotator-window{ position:relative; height:auto; min-height: 84px; }
    .rotator-line{
      position:absolute; left:0; top:0; width:100%;
      opacity:0; transform: translateX(24px);
      transition: transform .45s ease, opacity .45s ease;
      will-change: transform, opacity;
    }
    .rotator-line.active{ opacity:1; transform: translateX(0); }
    .rotator-title{
      display:block; font-family:'Bebas Neue',sans-serif; text-transform:uppercase;
      letter-spacing:.08em; font-size:1.05rem; color:rgba(0,212,255,0.85); margin-bottom:.25rem;
    }
    .rotator-text{ display:block; font-size:1.2rem; line-height:1.65; color:#d8ecff; }

    .rotator-underline{
      display:block; height:3px; width:100%; border-radius:999px; margin-top:.75rem;
      background:linear-gradient(90deg, rgba(0,212,255,0), rgba(0,212,255,.85), rgba(255,255,255,0));
      transform-origin:left center; animation: underlineGrow .6s ease both;
    }
    @keyframes underlineGrow{ from{ transform:scaleX(0); opacity:.4;} to{ transform:scaleX(1); opacity:1;} }

    .rotator-dots{ display:flex; gap:.5rem; margin-top:.45rem; }
    .rotator-dots .dot{
      width:10px; height:10px; border-radius:50%; border:1.5px solid #00d4ff;
      background:transparent; opacity:.7; cursor:pointer;
      transition: transform .2s ease, opacity .2s ease, background-color .2s ease;
    }
    .rotator-dots .dot.active{ background:#00d4ff; opacity:1; transform:scale(1.05); }

    /* Slight nudge of whole card on change for ‚Äúbox is moving‚Äù feel */
    .rotator-card.bump{ animation: cardBump .35s ease; }
    @keyframes cardBump{ 0%{ transform:translateX(0);} 40%{ transform:translateX(6px);} 100%{ transform:translateX(0);} }

    /* ===== ABOUT (restored) ===== */
    .about-section { padding: 6em 2em 7em; }
    .about-inner{
      max-width:1100px; margin:0 auto; display:flex; align-items:flex-start; justify-content:space-between; gap:3rem;
      background: rgba(0,0,0,0.55); border: 1px solid rgba(0,212,255,0.25); border-radius: 28px; padding: 3em;
      box-shadow: 0 40px 90px rgba(0,0,0,0.45); position:relative;
    }
    .about-intro{ letter-spacing:.35rem; font-size:.85rem; text-transform:uppercase; color:rgba(0,212,255,0.75); margin-bottom:1rem; }
    .about-title{ margin-bottom:1.2rem; position:relative; }
    .about-script{ font-family:'Great Vibes', cursive; font-size:4rem; text-transform:lowercase; color:#f3fbff; letter-spacing:.1rem; position:relative; }
    .about-script::after{
      content:""; position:absolute; left:0; bottom:-6px; height:4px; width:100%;
      background: linear-gradient(90deg, rgba(0,212,255,0) 0%, rgba(0,212,255,0.8) 35%, rgba(0,212,255,1) 55%, rgba(0,212,255,0) 100%);
      border-radius:999px; transform-origin:left center; animation: underlineGrow .7s ease .3s both;
    }
    .about-slogan{ font-size:1.35rem; color:#d2ebff; line-height:1.6; margin-bottom:1.75rem; max-width:28ch; }
    .about-description{ display:grid; gap:1rem; color:#cfe9ff; font-size:1.05rem; line-height:1.7; }
    .about-soap{
      font-size:5rem; color:#00d4ff; position:absolute; left:76%; top:58%;
      transform:translate(-50%,-50%); pointer-events:none; z-index:2;
    }
    .about-soap::before{
      content:""; position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      width:220px; height:220px; border-radius:50%;
      background: radial-gradient(circle, rgba(0,212,255,.38) 0%, rgba(0,212,255,0) 70%);
      filter: blur(20px); z-index:-1;
    }

    /* iOS-only quick fixes keep working via style.css rules */
  </style>
</head>
<body>

  <!-- NAVIGATION -->
  <header class="navbar">
    <div class="logo">
      <span class="soap">üßº</span>
      <a class="logo-text" href="/">DufferinDeepClean</a>
    </div>
    <nav class="nav-links">
      <a href="#home">Home</a>
      <a href="#services">Services</a>
      <a href="#about">About Us</a>
      <a href="book.html" class="quote-btn">Book Online</a>
    </nav>
  </header>

  <!-- Announcement -->
  <div class="announcement" role="region" aria-label="Promotion">
    <div class="announcement-inner">
      <p class="announce-line">999-999-999</p>
      <a class="announcement-cta" href="tel:+1999999999">Call Today</a>
    </div>
  </div>

  <!-- HERO -->
  <section id="home" class="split-screen">
    <div class="text-side">
      <h1 class="headline">
        <span>We</span> <span>Scrub</span> <span>You</span> <span>Shine</span>
        <img src="cleanerguy.png" alt="Cleaner" class="headline-image" />
      </h1>

      <div class="rotator-card" id="service-rotator">
        <div class="rotator-window" aria-live="polite">
          <div class="rotator-line active" data-title="Residential Homes">
            <span class="rotator-title">Residential Homes</span>
            <span class="rotator-text">We don‚Äôt just tidy houses. We deep clean homes.</span>
          </div>
          <div class="rotator-line" data-title="Commercial Buildings">
            <span class="rotator-title">Commercial Buildings</span>
            <span class="rotator-text">Commercial spaces collect more than dust. We remove it all.</span>
          </div>
          <div class="rotator-line" data-title="Offices / Workspaces">
            <span class="rotator-title">Offices / Workspaces</span>
            <span class="rotator-text">Clean offices look professional. Deep clean offices stay professional.</span>
          </div>
        </div>
        <span class="rotator-underline" aria-hidden="true"></span>
        <div class="rotator-dots" role="tablist" aria-label="Service types">
          <button class="dot active" aria-label="Residential Homes" role="tab"></button>
          <button class="dot" aria-label="Commercial Buildings" role="tab"></button>
          <button class="dot" aria-label="Offices / Workspaces" role="tab"></button>
        </div>
      </div>

      <div id="quote" class="hero-quote" aria-labelledby="quote-title">
        <div class="quote-card">
          <div class="quote-card-header">
            <h2 id="quote-title">custom cleaning quote</h2>
            <p>Answer a few quick questions to unlock a tailored estimate for your space.</p>
          </div>

          <form id="instant-quote" class="quote-form" novalidate>
            <div class="quote-grid">
              <label class="field" for="quote-first-name">
                <span class="field-label">First Name</span>
                <input id="quote-first-name" name="first-name" type="text" placeholder="e.g. Jordan" autocomplete="given-name" data-required>
              </label>

              <label class="field" for="quote-email">
                <span class="field-label">Email</span>
                <input id="quote-email" name="email" type="email" placeholder="you@example.com" autocomplete="email" data-required>
              </label>

              <label class="field" for="quote-service">
                <span class="field-label">Type of Cleaning Service</span>
                <select id="quote-service" name="service" data-required>
                  <option value="" disabled selected>Select a service</option>
                  <option value="home">Home General Cleaning</option>
                  <option value="commercial">Factory / Commercial / Industrial Cleaning</option>
                  <option value="office">Office Workspace Cleaning</option>
                </select>
              </label>

              <label class="field" for="quote-square-footage">
                <span class="field-label">Square Footage</span>
                <select id="quote-square-footage" name="square-footage" data-required>
                  <option value="" disabled selected>Select the range</option>
                  <option value="1000-1500">1,000 ‚Äì 1,500 sq ft</option>
                  <option value="1500-2000">1,500 ‚Äì 2,000 sq ft</option>
                  <option value="2000-2500">2,000 ‚Äì 2,500 sq ft</option>
                  <option value="2500-3000">2,500 ‚Äì 3,000 sq ft</option>
                  <option value="3000-3500">3,000 ‚Äì 3,500 sq ft</option>
                  <option value="3500-4000">3,500 ‚Äì 4,000 sq ft</option>
                </select>
              </label>
            </div>

            <div class="quote-summary" aria-live="polite">
              <div class="quote-summary-line">
                <span>Base Estimate</span>
                <strong id="quote-base-price">‚Äî</strong>
              </div>
              <div class="quote-summary-line total">
                <span>Total with Customizations</span>
                <strong id="quote-total-price">‚Äî</strong>
              </div>
            </div>

            <div id="quote-customize" class="quote-customize" aria-hidden="true">
              <div class="customize-heading" role="status">Customize your cleaning</div>

              <div class="addon-groups">
                <div class="addon-group" data-service-group="home">
                  <p class="addon-group-title">Home &amp; Residential Extras</p>
                  <div class="addon-pill color-cyan" data-addon="Deep Clean Package" data-price="80">
                    <span class="addon-icon">‚ú®</span>
                    <span class="addon-name">Deep Clean Package</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Deep Clean Package quantity">
                  </div>
                  <div class="addon-pill color-lime" data-addon="Move In/Out Clean Package" data-price="95">
                    <span class="addon-icon">üöö</span>
                    <span class="addon-name">Move In/Out Clean Package</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Move In/Out Clean Package quantity">
                  </div>
                  <div class="addon-pill color-magenta" data-addon="Renovation Clean Package" data-price="110">
                    <span class="addon-icon">üõ†Ô∏è</span>
                    <span class="addon-name">Renovation Clean Package</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Renovation Clean Package quantity">
                  </div>
                  <div class="addon-pill color-orange" data-addon="Move In/Out Package (Student Property)" data-price="70">
                    <span class="addon-icon">üéì</span>
                    <span class="addon-name">Move In/Out Package (Student Property)</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Move In/Out Package (Student Property) quantity">
                  </div>
                  <div class="addon-pill color-indigo" data-addon="AirBnB Listing" data-price="65">
                    <span class="addon-icon">üè†</span>
                    <span class="addon-name">AirBnB Listing</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="AirBnB Listing quantity">
                  </div>
                  <div class="addon-pill color-gold" data-addon="I have Pets" data-price="35">
                    <span class="addon-icon">üêæ</span>
                    <span class="addon-name">I have Pets</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="I have Pets quantity">
                  </div>
                  <div class="addon-pill color-sky" data-addon="Inside Fridge" data-price="25">
                    <span class="addon-icon">üßä</span>
                    <span class="addon-name">Inside Fridge</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Inside Fridge quantity">
                  </div>
                  <div class="addon-pill color-rose" data-addon="Inside Oven" data-price="25">
                    <span class="addon-icon">üî•</span>
                    <span class="addon-name">Inside Oven</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Inside Oven quantity">
                  </div>
                  <div class="addon-pill color-mint" data-addon="Inside Cabinets" data-price="30">
                    <span class="addon-icon">üóÑÔ∏è</span>
                    <span class="addon-name">Inside Cabinets</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Inside Cabinets quantity">
                  </div>
                  <div class="addon-pill color-teal" data-addon="Additional Kitchen" data-price="45">
                    <span class="addon-icon">üçΩÔ∏è</span>
                    <span class="addon-name">Additional Kitchen</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Additional Kitchen quantity">
                  </div>
                  <div class="addon-pill color-plum" data-addon="Blinds (per window)" data-price="8">
                    <span class="addon-icon">ü™ü</span>
                    <span class="addon-name">Blinds (per window)</span>
                    <input class="addon-qty" type="number" min="1" max="25" value="1" aria-label="Blinds quantity">
                  </div>
                  <div class="addon-pill color-azure" data-addon="Inside Windows with Tracks (up to 6)" data-price="60">
                    <span class="addon-icon">üîç</span>
                    <span class="addon-name">Inside Windows with Tracks (up to 6)</span>
                    <input class="addon-qty" type="number" min="1" max="5" value="1" aria-label="Inside Windows with Tracks up to 6 quantity">
                  </div>
                  <div class="addon-pill color-amber" data-addon="Inside Windows with Tracks (up to 12)" data-price="105">
                    <span class="addon-icon">üîé</span>
                    <span class="addon-name">Inside Windows with Tracks (up to 12)</span>
                    <input class="addon-qty" type="number" min="1" max="5" value="1" aria-label="Inside Windows with Tracks up to 12 quantity">
                  </div>
                  <div class="addon-pill color-blue" data-addon="Inside Windows with Tracks (up to 24)" data-price="195">
                    <span class="addon-icon">ü™ü</span>
                    <span class="addon-name">Inside Windows with Tracks (up to 24)</span>
                    <input class="addon-qty" type="number" min="1" max="5" value="1" aria-label="Inside Windows with Tracks up to 24 quantity">
                  </div>
                  <div class="addon-pill color-lavender" data-addon="Change Bed Sheets + Load Laundry" data-price="18">
                    <span class="addon-icon">üõèÔ∏è</span>
                    <span class="addon-name">Change Bed Sheets + Load Laundry</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Change Bed Sheets quantity">
                  </div>
                  <div class="addon-pill color-crimson" data-addon="Load dishwasher" data-price="10">
                    <span class="addon-icon">üçΩÔ∏è</span>
                    <span class="addon-name">Load Dishwasher</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Load Dishwasher quantity">
                  </div>
                  <div class="addon-pill color-emerald" data-addon="Sanitization Package" data-price="55">
                    <span class="addon-icon">üß¥</span>
                    <span class="addon-name">Sanitization Package</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Sanitization Package quantity">
                  </div>
                </div>

                <div class="addon-group" data-service-group="commercial,office">
                  <p class="addon-group-title">Facility &amp; Workspace Enhancements</p>
                  <div class="addon-pill color-indigo" data-addon="Carpet Steam Cleaning Package" data-price="140">
                    <span class="addon-icon">üßº</span>
                    <span class="addon-name">Carpet Steam Cleaning Package</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Carpet Steam Cleaning quantity">
                  </div>
                  <div class="addon-pill color-azure" data-addon="Tile and Grout Cleaning Package" data-price="130">
                    <span class="addon-icon">üßΩ</span>
                    <span class="addon-name">Tile and Grout Cleaning Package</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Tile and Grout Cleaning quantity">
                  </div>
                  <div class="addon-pill color-mint" data-addon="Restock Bathroom Supply" data-price="40">
                    <span class="addon-icon">üßª</span>
                    <span class="addon-name">Restock Bathroom Supply</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Restock Bathroom Supply quantity">
                  </div>
                  <div class="addon-pill color-gold" data-addon="Disinfect Electronics" data-price="45">
                    <span class="addon-icon">üíª</span>
                    <span class="addon-name">Disinfect Electronics</span>
                    <input class="addon-qty" type="number" min="1" max="10" value="1" aria-label="Disinfect Electronics quantity">
                  </div>
                  <div class="addon-pill color-teal" data-addon="Empty Garbage/Recycling" data-price="18">
                    <span class="addon-icon">üóëÔ∏è</span>
                    <span class="addon-name">Empty Garbage/Recycling</span>
                    <input class="addon-qty" type="number" min="1" max="20" value="1" aria-label="Empty Garbage/Recycling quantity">
                  </div>
                  <div class="addon-pill color-lime" data-addon="Water Plants" data-price="15">
                    <span class="addon-icon">üåø</span>
                    <span class="addon-name">Water Plants</span>
                    <input class="addon-qty" type="number" min="1" max="20" value="1" aria-label="Water Plants quantity">
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>

      <a href="tel:+1999999999" class="quote-btn-home">Call Now</a>
      <a href="#services" class="services-btn-home">Our Services</a>
    </div>

    <div class="image-side">
      <div class="image-top-diffuse" aria-hidden="true"></div>
      <div class="hero-carousel" id="hero-carousel" role="region" aria-label="Showcase photos">
        <div class="hero-slide active" data-index="0">
          <img src="cleanuptransformation.jpg" alt="Cleanup transformation image" />
        </div>
        <div class="hero-slide" data-index="1">
          <img src="IMG_3541.png" alt="Cleaning crew wiping down stainless steel surfaces" />
        </div>
        <div class="hero-slide" data-index="2">
          <img src="IMG_1629.png" alt="Freshly cleaned office lobby with seating area" />
        </div>
        <div class="hero-slide" data-index="3">
          <img src="IMG_1487.png" alt="Sanitized kitchen counter shining under lights" />
        </div>
        <div class="hero-dots" role="tablist" aria-label="Hero image navigation">
          <button type="button" class="hero-dot active" aria-label="Cleanup transformation image" role="tab"></button>
          <button type="button" class="hero-dot" aria-label="Cleaning crew wiping down stainless steel surfaces" role="tab"></button>
          <button type="button" class="hero-dot" aria-label="Freshly cleaned office lobby with seating area" role="tab"></button>
          <button type="button" class="hero-dot" aria-label="Sanitized kitchen counter shining under lights" role="tab"></button>
        </div>
      </div>
    </div>
  </section>

  <!-- SERVICES -->
  <section id="services" class="services-page">
    <div class="services-header">
      <h1>our services</h1>
      <p>Professional cleaning solutions tailored to your needs. From warehouses to offices, we deliver exceptional results every time.</p>
    </div>

    <div class="services-grid">
      <a class="service-card" href="book.html?pkg=industrial&service=Industrial%20%26%20Warehouse%20Deep%20Clean#start">
        <img src="img/warehouse-deep-clean.jpg" alt="Warehouse deep cleaning with floor scrubber and high-dusting" class="service-image" />
        <h3>industrial &amp; warehouse deep clean</h3>
        <p>Heavy-duty cleaning for aisles, docks, and production floors‚Äîdegreasing, machine wipe-downs, and high-dusting of beams &amp; racking.</p>
        <span class="service-cta">book this</span>
      </a>

      <a class="service-card" href="book.html?pkg=office&service=Office%20Deep%20Clean#start">
        <img src="img/office-deep-clean.jpg" alt="Office deep clean: tidy desks, mopped floors, stocked restrooms" class="service-image" />
        <h3>office deep clean</h3>
        <p>Workstations, meeting rooms, and common areas‚Äîvacuum &amp; mop, bin service &amp; recycling, restroom sanitization and supply refill.</p>
        <span class="service-cta">book this</span>
      </a>

      <a class="service-card" href="book.html?pkg=specialty&service=High-Reach%20Window%20%26%20Rail%20Cleaning%20(Scissor%20Lift)%20%E2%80%94%20Warehouses#start">
        <img src="img/highreach-warehouse.jpg" alt="Scissor-lift crew cleaning warehouse high windows and rails" class="service-image" />
        <h3>high-reach window &amp; rail (warehouses)</h3>
        <p>Clear glass and safe rails at height‚Äîperformed with scissor lifts (no rope-access). Frames, tracks, and mezzanine rails detailed and sanitized.</p>
        <span class="service-cta">book this</span>
      </a>
    </div>
  </section>

  <!-- ABOUT (restored) -->
  <section id="about" class="about-section">
    <div class="about-inner">
      <div class="about-content">
        <p class="about-intro">A quick reminder of who we are</p>
        <h2 class="about-title">
          <span class="about-script">about us</span>
        </h2>
        <p class="about-slogan">We scrub with heart so your team can focus on what matters.</p>
        <p class="about-description">
          <span>Family-built, people-first cleaning crews who respect every facility we enter.</span>
          <span>We show up on time, finish the tough jobs, and leave every surface ready to shine.</span>
          <span>Trusted by Homeowners, Offices and warehouses across Ontario. Get a free, no-obligation quote within one business day.</span>
        </p>
      </div>
      <div class="about-soap" aria-hidden="true">üßº</div>
    </div>
  </section>

  <!-- Quote logic -->
  <script>
    (function(){
      const form = document.getElementById('instant-quote');
      if(!form) return;

      const requiredFields = Array.from(form.querySelectorAll('[data-required]'));
      const basePriceEl = document.getElementById('quote-base-price');
      const totalPriceEl = document.getElementById('quote-total-price');
      const customizeBlock = document.getElementById('quote-customize');
      const serviceSelect = document.getElementById('quote-service');
      const sqftSelect = document.getElementById('quote-square-footage');
      const addonGroups = Array.from(form.querySelectorAll('.addon-group'));
      const addonPills = Array.from(form.querySelectorAll('.addon-pill'));

      const basePricing = {
        home: {
          '1000-1500': 165,
          '1500-2000': 185,
          '2000-2500': 215,
          '2500-3000': 245,
          '3000-3500': 285,
          '3500-4000': 325
        },
        commercial: {
          '1000-1500': 240,
          '1500-2000': 285,
          '2000-2500': 330,
          '2500-3000': 380,
          '3000-3500': 425,
          '3500-4000': 470
        },
        office: {
          '1000-1500': 210,
          '1500-2000': 250,
          '2000-2500': 295,
          '2500-3000': 335,
          '3000-3500': 375,
          '3500-4000': 420
        }
      };

      function hasAllRequired(){
        return requiredFields.every(field => {
          if(field.type === 'email'){
            return field.value.trim() !== '' && field.value.includes('@');
          }
          return field.value.trim() !== '';
        });
      }

      function resetAddons(){
        addonPills.forEach(pill => {
          pill.classList.remove('active');
          const qty = pill.querySelector('.addon-qty');
          if(qty){
            qty.value = 1;
            qty.disabled = true;
          }
          pill.setAttribute('aria-pressed', 'false');
        });
      }

      function updateAddonAvailability(serviceKey){
        addonGroups.forEach(group => {
          const services = group.dataset.serviceGroup.split(',');
          const match = services.includes(serviceKey);
          group.classList.toggle('active', match);
        });

        addonPills.forEach(pill => {
          const parent = pill.closest('.addon-group');
          const enabled = parent && parent.classList.contains('active');
          pill.style.display = enabled ? '' : 'none';
          if(!enabled){
            pill.classList.remove('active');
            const qty = pill.querySelector('.addon-qty');
            if(qty){
              qty.value = 1;
              qty.disabled = true;
            }
            pill.setAttribute('aria-pressed', 'false');
          }
        });
      }

      function calculateTotal(){
        const serviceKey = serviceSelect.value;
        const sqftKey = sqftSelect.value;
        if(!serviceKey || !sqftKey || !basePricing[serviceKey]){
          basePriceEl.textContent = '‚Äî';
          totalPriceEl.textContent = '‚Äî';
          return;
        }

        const base = basePricing[serviceKey][sqftKey] || 0;
        let total = base;

        addonPills.forEach(pill => {
          if(!pill.classList.contains('active')) return;
          const parent = pill.closest('.addon-group');
          if(!parent || !parent.classList.contains('active')) return;

          const price = Number(pill.dataset.price || 0);
          const qtyInput = pill.querySelector('.addon-qty');
          const qty = qtyInput ? Math.max(1, Number(qtyInput.value) || 1) : 1;
          total += price * qty;
        });

        basePriceEl.textContent = base ? `$${base.toFixed(0)}` : '‚Äî';
        totalPriceEl.textContent = total ? `$${total.toFixed(0)}` : '‚Äî';
      }

      function toggleCustomize(){
        const ready = hasAllRequired();
        customizeBlock.classList.toggle('visible', ready);
        customizeBlock.setAttribute('aria-hidden', ready ? 'false' : 'true');
        form.classList.toggle('quote-ready', ready);
        if(!ready){
          basePriceEl.textContent = '‚Äî';
          totalPriceEl.textContent = '‚Äî';
          resetAddons();
        } else {
          updateAddonAvailability(serviceSelect.value);
          calculateTotal();
        }
      }

      addonPills.forEach(pill => {
        pill.addEventListener('click', (event) => {
          if(!customizeBlock.classList.contains('visible')) return;
          const qtyInput = pill.querySelector('.addon-qty');
          if(event.target === qtyInput) return;

          pill.classList.toggle('active');
          if(qtyInput){
            qtyInput.disabled = !pill.classList.contains('active');
          }
          pill.setAttribute('aria-pressed', pill.classList.contains('active') ? 'true' : 'false');
          calculateTotal();
        });

        const qtyInput = pill.querySelector('.addon-qty');
        if(qtyInput){
          qtyInput.disabled = true;
          qtyInput.addEventListener('input', () => {
            if(!pill.classList.contains('active')) return;
            if(qtyInput.value === '' || Number(qtyInput.value) < Number(qtyInput.min)){
              qtyInput.value = qtyInput.min;
            }
            calculateTotal();
          });
        }

        pill.addEventListener('keydown', (evt) => {
          if(evt.key === 'Enter' || evt.key === ' '){
            evt.preventDefault();
            pill.click();
          }
        });
        pill.setAttribute('tabindex', '0');
        pill.setAttribute('role', 'button');
        pill.setAttribute('aria-pressed', 'false');
      });

      requiredFields.forEach(field => {
        const eventName = field.tagName === 'SELECT' ? 'change' : 'input';
        field.addEventListener(eventName, toggleCustomize);
      });

      serviceSelect.addEventListener('change', () => {
        updateAddonAvailability(serviceSelect.value);
        calculateTotal();
      });

      sqftSelect.addEventListener('change', calculateTotal);

      addonPills.forEach(pill => {
        pill.setAttribute('aria-pressed', 'false');
      });

      toggleCustomize();
    })();
  </script>

  <!-- iOS detector -->
  <script>
    (function () {
      var iOS =
        /iP(hone|od|ad)/.test(navigator.platform) ||
        (navigator.userAgent.includes('Mac') && navigator.maxTouchPoints > 1);
      if (iOS) document.documentElement.classList.add('ios');
    })();
  </script>

  <!-- Hero image carousel -->
  <script>
    (function(){
      const carousel = document.getElementById('hero-carousel');
      if(!carousel) return;

      const slides = Array.from(carousel.querySelectorAll('.hero-slide'));
      const dots = Array.from(carousel.querySelectorAll('.hero-dot'));
      let index = 0;
      let timer = null;

      function setActive(next){
        slides[index].classList.remove('active');
        slides[index].setAttribute('aria-hidden', 'true');
        dots[index].classList.remove('active');
        dots[index].setAttribute('aria-selected', 'false');

        index = (next + slides.length) % slides.length;

        slides[index].classList.add('active');
        slides[index].setAttribute('aria-hidden', 'false');
        dots[index].classList.add('active');
        dots[index].setAttribute('aria-selected', 'true');
      }

      function next(){ setActive(index + 1); }

      function start(){ stop(); timer = setInterval(next, 5000); }
      function stop(){ if(timer){ clearInterval(timer); timer = null; } }

      dots.forEach((dot, i)=>{
        dot.addEventListener('click', ()=>{ setActive(i); start(); });
        dot.addEventListener('keydown', (evt)=>{
          if(evt.key === 'Enter' || evt.key === ' '){ evt.preventDefault(); setActive(i); start(); }
        });
      });

      carousel.addEventListener('mouseenter', stop);
      carousel.addEventListener('mouseleave', start);
      carousel.addEventListener('touchstart', stop, {passive:true});
      carousel.addEventListener('touchend', ()=>{ start(); }, {passive:true});

      slides.forEach((slide, i)=> slide.setAttribute('aria-hidden', i === index ? 'false' : 'true'));
      dots.forEach((dot, i)=> dot.setAttribute('aria-selected', i === index ? 'true' : 'false'));
      setActive(0);
      start();
    })();
  </script>

  <!-- Rotator logic (slide + bump + swipe) -->
  <script>
    (function(){
      const box = document.getElementById('service-rotator');
      if(!box) return;

      const slides = Array.from(box.querySelectorAll('.rotator-line'));
      const dots   = Array.from(box.querySelectorAll('.rotator-dots .dot'));
      const underline = box.querySelector('.rotator-underline');
      let idx = 0, timer = null, touchStartX = 0;

      function show(n, bump=true){
        // remove current
        slides[idx].classList.remove('active');
        dots[idx].classList.remove('active');

        // set new
        idx = (n + slides.length) % slides.length;
        slides[idx].classList.add('active');
        dots[idx].classList.add('active');

        // restart underline anim
        underline.style.animation = 'none';
        requestAnimationFrame(()=>{ underline.style.animation = ''; });

        // nudge the whole box so it feels like it moved
        if(bump){ box.classList.remove('bump'); void box.offsetWidth; box.classList.add('bump'); }
      }

      function next(){ show(idx+1); }
      function start(){ stop(); timer = setInterval(next, 4200); }
      function stop(){ if(timer){ clearInterval(timer); timer=null; } }

      // dots
      dots.forEach((d,i)=> d.addEventListener('click', ()=>{ show(i); start(); }));

      // swipe
      box.addEventListener('touchstart', e=>{ touchStartX = e.touches[0].clientX; }, {passive:true});
      box.addEventListener('touchend', e=>{
        const dx = e.changedTouches[0].clientX - touchStartX;
        if(Math.abs(dx) > 40){ show(idx + (dx<0 ? 1 : -1)); start(); }
      }, {passive:true});

      // hover pause (desktop)
      box.addEventListener('mouseenter', stop);
      box.addEventListener('mouseleave', start);

      // init
      slides.forEach((s,i)=> s.style.zIndex = String(10 - i));
      show(0,false); start();
    })();
  </script>
</body>
</html>
